24
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Admin - MindSight Elite 360</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; }
        #login, #dashboard { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        form { display: flex; flex-direction: column; }
        label { margin: 10px 0 5px; }
        input, select, button, textarea { padding: 10px; margin-bottom: 10px; }
        #analysisOutput { margin-top: 20px; padding: 10px; background: #e0f7fa; border: 1px solid #00acc1; }
        #athletesTable, #analysesTable { margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background: #f2f2f2; }
        .hidden { display: none !important; }
        button { background: #007cba; color: white; border: none; cursor: pointer; }
        button:hover { background: #005a87; }
        button.edit-btn, button.delete-btn, button.save-btn { padding: 5px; font-size: 12px; margin-right: 5px; }
        .edit-btn { background: #4CAF50; }
        .delete-btn { background: #f44336; }
        .save-btn { background: #2196F3; }
        input.edit-field, textarea { display: none; width: 100%; box-sizing: border-box; }
    </style>
</head>
<body>
    <div id="login">
        <h2>Login Admin</h2>
        <form id="loginForm">
            <label for="username">Usuario:</label>
            <input type="text" id="username" required>
            <label for="password">ContraseÃ±a:</label>
            <input type="password" id="password" required>
            <button type="submit">Ingresar</button>
        </form>
    </div>
    <div id="dashboard" class="hidden">
        <h2>Dashboard Admin - MindSight Elite 360</h2>
       
        <h3>Agregar Deportista</h3>
        <form id="athleteForm">
            <label for="nombre">Nombre:</label>
            <input type="text" id="nombre" required>
            <label for="apellidos">Apellidos:</label>
            <input type="text" id="apellidos" required>
            <label for="telefono">TelÃ©fono:</label>
            <input type="tel" id="telefono" required>
            <label for="mail">Email:</label>
            <input type="email" id="mail" required>
            <label for="deporte">Deporte:</label>
            <input type="text" id="deporte" required>
            <label for="fecha_nacimiento">Fecha de Nacimiento (YYYY-MM-DD):</label>
            <input type="date" id="fecha_nacimiento" required>
            <label for="hora_nacimiento">Hora de Nacimiento (HH:MM):</label>
            <input type="time" id="hora_nacimiento" required>
            <button type="submit">Guardar Deportista</button>
        </form>

        <h3>Deportistas Registrados</h3>
        <table id="athletesTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Apellidos</th>
                    <th>TelÃ©fono</th>
                    <th>Email</th>
                    <th>Deporte</th>
                    <th>Fecha Nacimiento</th>
                    <th>Hora Nacimiento</th>
                    <th>AnÃ¡lisis</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <h3>AnÃ¡lisis de Objeto (Vinculado a Deportista)</h3>
        <form id="analysisForm">
            <label for="athleteIdForAnalysis">Seleccionar Deportista:</label>
            <select id="athleteIdForAnalysis" required>
                <option value="">-- Elegir --</option>
            </select>
            <label for="objeto">Objeto:</label>
            <select id="objeto" required>
                <option value="">-- Seleccionar --</option>
                <option value="espejo">Espejo</option>
                <option value="puerta">Puerta</option>
                <option value="reloj">Reloj</option>
                <option value="libro">Libro</option>
                <option value="rio">RÃ­o</option>
                <option value="vela">Vela</option>
                <option value="puente">Puente</option>
                <option value="llave">Llave</option>
                <option value="coche">Coche</option>
                <option value="casa">Casa</option>
            </select>
            <label for="estado">Estado:</label>
            <select id="estado" required>
                <option value="">-- Seleccionar --</option>
                <option value="roto">Roto</option>
                <option value="sucio">Sucio</option>
                <option value="limpio">Limpio</option>
                <option value="brillante">Brillante</option>
                <option value="oscuro">Oscuro</option>
                <option value="abierto">Abierto</option>
                <option value="cerrado">Cerrado</option>
                <option value="flotante">Flotante</option>
                <option value="hundido">Hundido</option>
                <option value="viejo">Viejo</option>
                <option value="nuevo">Nuevo</option>
                <option value="otro">Otro (especificar en notas)</option>
            </select>
            <label for="notas_estado">Notas (si seleccionaste "Otro" en estado):</label>
            <textarea id="notas_estado"></textarea>
            <label for="color">Color:</label>
            <select id="color" required>
                <option value="">-- Seleccionar --</option>
                <option value="dorado">Dorado</option>
                <option value="negro">Negro</option>
                <option value="blanco">Blanco</option>
                <option value="rojo">Rojo</option>
                <option value="azul">Azul</option>
                <option value="rosa">Rosa</option>
                <option value="violeta">Violeta</option>
                <option value="verde">Verde</option>
                <option value="amarillo">Amarillo</option>
                <option value="gris">Gris</option>
                <option value="naranja">Naranja</option>
                <option value="marron">MarrÃ³n</option>
            </select>
            <label for="textura">Textura:</label>
            <select id="textura" required>
                <option value="">-- Seleccionar --</option>
                <option value="lisa">Lisa</option>
                <option value="aspera">Ãspera</option>
                <option value="pegajosa">Pegajosa</option>
                <option value="fria">FrÃ­a</option>
                <option value="caliente">Caliente</option>
                <option value="suave">Suave</option>
                <option value="dura">Dura</option>
                <option value="humeda">HÃºmeda</option>
                <option value="seca">Seca</option>
                <option value="brillante">Brillante</option>
                <option value="opaca">Opaca</option>
            </select>
            <label for="tamaÃ±o">TamaÃ±o:</label>
            <select id="tamaÃ±o" required>
                <option value="">-- Seleccionar --</option>
                <option value="minusculo">MinÃºsculo</option>
                <option value="pequeÃ±o">PequeÃ±o</option>
                <option value="mediano">Mediano</option>
                <option value="grande">Grande</option>
                <option value="gigante">Gigante</option>
            </select>
            <button type="submit">Analizar y Guardar</button>
        </form>
        <div id="analysisOutput"></div>

        <h3>AnÃ¡lisis por Deportista</h3>
        <select id="viewAthlete" onchange="loadAnalyses()">
            <option value="">-- Elegir Deportista --</option>
        </select>
        <table id="analysesTable" class="hidden">
            <thead>
                <tr>
                    <th>Objeto</th>
                    <th>Estado</th>
                    <th>Color</th>
                    <th>Textura</th>
                    <th>TamaÃ±o</th>
                    <th>Simbolismo</th>
                    <th>Trauma</th>
                    <th>Fecha AnÃ¡lisis</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <button onclick="exportData()">Exportar Datos (CSV)</button>
        <button onclick="logout()">Cerrar SesiÃ³n</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            console.log("DOM cargado, iniciando configuraciÃ³n de login");
            
            // Login
            const adminUser = "admin";
            const adminPass = "mindsight123";
            const loginForm = document.getElementById("loginForm");
            const loginDiv = document.getElementById("login");
            const dashboardDiv = document.getElementById("dashboard");

            if (!loginForm) {
                console.error("Error: Elemento loginForm no encontrado");
                alert("Error crÃ­tico: Formulario de login no encontrado. Verifica el HTML.");
                return;
            }
            if (!loginDiv || !dashboardDiv) {
                console.error("Error: Elementos login o dashboard no encontrados", { loginDiv, dashboardDiv });
                alert("Error crÃ­tico: Elementos de interfaz no encontrados. Verifica el HTML.");
                return;
            }

            loginForm.addEventListener("submit", function(e) {
                e.preventDefault();
                console.log("Formulario de login enviado");
                const user = document.getElementById("username")?.value.trim();
                const pass = document.getElementById("password")?.value.trim();

                if (!user || !pass) {
                    console.error("Usuario o contraseÃ±a vacÃ­os", { user, pass });
                    alert("Por favor, completa ambos campos.");
                    return;
                }

                console.log("Verificando credenciales", { user, pass });
                if (user === adminUser && pass === adminPass) {
                    console.log("Credenciales correctas, mostrando dashboard");
                    loginDiv.classList.add("hidden");
                    dashboardDiv.classList.remove("hidden");
                    loginForm.reset();
                    console.log("Cargando datos iniciales");
                    loadAthletes();
                    loadAthleteSelects();
                } else {
                    console.error("Credenciales incorrectas", { user, pass });
                    alert("Usuario o contraseÃ±a incorrectos. Usa: admin / mindsight123");
                }
            });

            function logout() {
                console.log("Cerrando sesiÃ³n");
                dashboardDiv.classList.add("hidden");
                loginDiv.classList.remove("hidden");
                loginForm.reset();
            }

            // Resto del cÃ³digo (gestiÃ³n de deportistas, anÃ¡lisis, etc.)
            const objects = {
                "espejo": "Ego/Auto-percepciÃ³n (Arquetipo de la Sombra)",
                "puerta": "Transiciones/Cambio (Arquetipo del Umbral)",
                "reloj": "RelaciÃ³n con el Tiempo (Arquetipo del Viejo Sabio)",
                "libro": "Infancia/Aprendizaje (Arquetipo del Conocimiento)",
                "rio": "Emociones/Flujo (Arquetipo de la Gran Madre)",
                "vela": "Esperanza/Espiritualidad (Arquetipo de la Luz)",
                "puente": "Relaciones/Conexiones (Arquetipo de la UniÃ³n)",
                "llave": "Acceso/Secretos (Arquetipo de la SoluciÃ³n)",
                "coche": "AutonomÃ­a/Independencia (Arquetipo del Viaje)",
                "casa": "Familia/Hogar Interno (Arquetipo del Yo)"
            };
            const states = {
                "espejo": {
                    "roto": ["FragmentaciÃ³n del yo", "Trauma por auto-rechazo o identidad rota.", "Â¿QuÃ© parte de ti no quieres ver? Â¿QuÃ© rompiÃ³ el espejo?", "Visualiza el espejo reparado, entero, reflejando tu yo completo con claridad."],
                    "sucio": ["ConfusiÃ³n interna", "Bloqueos que nublan la auto-percepciÃ³n.", "Â¿QuÃ© ensucia tu reflejo? Â¿QuÃ© necesitas limpiar?", "Visualiza el espejo limpio, pulido, mostrando tu verdad."],
                    "limpio": ["Claridad de conciencia", "Progreso en integrar la sombra.", "Â¿QuÃ© ves claramente ahora? Â¿QuÃ© te empodera?", "MantÃ©n el espejo limpio, reflejando tu fuerza interior."],
                    "brillante": ["IntegraciÃ³n del yo", "ConexiÃ³n con el inconsciente luminoso.", "Â¿QuÃ© ilumina tu reflejo? Â¿QuÃ© te inspira?", "Visualiza el espejo brillando intensamente, amplificando tu luz interior."],
                    "oscuro": ["Sombra reprimida", "Miedo a enfrentar aspectos ocultos.", "Â¿QuÃ© oculta la oscuridad? Â¿QuÃ© temes ver?", "Visualiza el espejo iluminado, revelando tu yo sin miedo."],
                    "abierto": ["Vulnerabilidad del yo", "ExposiciÃ³n excesiva de la psique.", "Â¿QuÃ© expones al abrirte? Â¿QuÃ© necesitas proteger?", "Visualiza el espejo con un marco protector, reflejando solo lo esencial."],
                    "cerrado": ["Rechazo del yo", "NegaciÃ³n de la auto-observaciÃ³n.", "Â¿Por quÃ© evitas mirarte? Â¿QuÃ© temes descubrir?", "Visualiza el espejo abierto, invitando a la auto-aceptaciÃ³n."],
                    "flotante": ["DesconexiÃ³n del yo", "EvasiÃ³n de la realidad interna.", "Â¿Por quÃ© flota tu reflejo? Â¿QuÃ© evitas?", "Visualiza el espejo anclado, conectado a tu verdad."],
                    "hundido": ["DepresiÃ³n del yo", "Peso emocional que oculta la autoimagen.", "Â¿QuÃ© hunde tu reflejo? Â¿QuÃ© carga llevas?", "Visualiza el espejo emergiendo, claro y ligero."],
                    "viejo": ["Apego al pasado", "Traumas antiguos que definen la autoimagen.", "Â¿QuÃ© recuerdos guarda el espejo? Â¿QuÃ© necesitas soltar?", "Visualiza el espejo renovado, reflejando un presente libre."],
                    "nuevo": ["RenovaciÃ³n del yo", "Oportunidad para redefinir la autoimagen.", "Â¿QuÃ© nueva imagen ves? Â¿QuÃ© comienzas?", "Visualiza el espejo nuevo, reflejando un yo fortalecido."],
                    "otro": ["Definido por notas", "Trauma personalizado.", "Especifica en notas quÃ© simboliza este estado.", "Visualiza el espejo segÃºn las notas, en un estado ideal de claridad."]
                },
                "puerta": {
                    "roto": ["Transiciones bloqueadas", "Miedo al cambio o trauma por oportunidades perdidas.", "Â¿QuÃ© rompiÃ³ la puerta? Â¿QuÃ© temes cruzar?", "Visualiza la puerta reparada, abriÃ©ndose a nuevas posibilidades."],
                    "sucio": ["Barreras emocionales", "Resistencia al cambio por acumulaciÃ³n de traumas.", "Â¿QuÃ© ensucia la puerta? Â¿QuÃ© necesitas soltar?", "Visualiza la puerta limpia, lista para abrirse con facilidad."],
                    "limpio": ["PreparaciÃ³n para el cambio", "Progreso en aceptar transiciones.", "Â¿QuÃ© te permite avanzar? Â¿QuÃ© estÃ¡ claro?", "MantÃ©n la puerta limpia, lista para cruzar con confianza."],
                    "brillante": ["Oportunidad luminosa", "Apertura a nuevas fases de vida.", "Â¿QuÃ© ilumina el camino? Â¿QuÃ© te motiva?", "Visualiza la puerta brillando, invitando a un futuro positivo."],
                    "oscuro": ["Miedo al cambio", "Trauma que oscurece las transiciones.", "Â¿QuÃ© oscurece la puerta? Â¿QuÃ© temes?", "Visualiza la puerta iluminada, abriendo un camino claro."],
                    "abierto": ["Receptividad al cambio", "Oportunidad para explorar el inconsciente.", "Â¿QuÃ© hay al otro lado? Â¿EstÃ¡s listo?", "Visualiza la puerta abierta, fluida y acogedora."],
                    "cerrado": ["Aislamiento defensivo", "Miedo a lo desconocido o trauma protector.", "Â¿Por quÃ© estÃ¡ cerrada? Â¿QuÃ© protege?", "Visualiza la puerta abriÃ©ndose lentamente, con seguridad."],
                    "flotante": ["DesconexiÃ³n de transiciones", "EvasiÃ³n de decisiones importantes.", "Â¿Por quÃ© flota la puerta? Â¿QuÃ© evitas decidir?", "Visualiza la puerta anclada, conectada a un camino firme."],
                    "hundido": ["Estancamiento en transiciones", "Peso que impide avanzar.", "Â¿QuÃ© hunde la puerta? Â¿QuÃ© te retiene?", "Visualiza la puerta emergiendo, lista para abrirse."],
                    "viejo": ["Carga del pasado", "Transiciones bloqueadas por experiencias antiguas.", "Â¿QuÃ© pasado guarda la puerta? Â¿QuÃ© necesitas soltar?", "Visualiza la puerta renovada, abriendo un presente libre."],
                    "nuevo": ["RenovaciÃ³n de oportunidades", "Inicio de una nueva fase.", "Â¿QuÃ© abre esta puerta? Â¿QuÃ© comienzas?", "Visualiza la puerta nueva, abriendo un futuro brillante."],
                    "otro": ["Definido por notas", "Trauma personalizado.", "Especifica en notas quÃ© simboliza este estado.", "Visualiza la puerta segÃºn las notas, en un estado ideal de apertura."]
                },
                "reloj": {
                    "roto": ["Ansiedad temporal", "Trauma por pÃ©rdida de control del tiempo.", "Â¿QuÃ© detuvo el reloj? Â¿QuÃ© tiempo temes?", "Visualiza el reloj reparado, marcando un ritmo tranquilo."],
                    "sucio": ["ConfusiÃ³n temporal", "Bloqueos que nublan la percepciÃ³n del tiempo.", "Â¿QuÃ© ensucia el reloj? Â¿QuÃ© necesitas aclarar?", "Visualiza el reloj limpio, funcionando con precisiÃ³n."],
                    "limpio": ["Claridad temporal", "Progreso en aceptar el flujo del tiempo.", "Â¿QuÃ© controlas ahora? Â¿QuÃ© te da paz?", "MantÃ©n el reloj limpio, marcando un ritmo armÃ³nico."],
                    "brillante": ["ArmonÃ­a con el tiempo", "IntegraciÃ³n del ritmo vital.", "Â¿QuÃ© ilumina el reloj? Â¿QuÃ© aceptas?", "Visualiza el reloj brillando, en perfecta sincronÃ­a."],
                    "oscuro": ["Miedo al tiempo", "Trauma por el paso inexorable del tiempo.", "Â¿QuÃ© oscurece el reloj? Â¿QuÃ© temes perder?", "Visualiza el reloj iluminado, marcando un presente libre."],
                    "abierto": ["ExposiciÃ³n temporal", "Vulnerabilidad al ritmo de la vida.", "Â¿QuÃ© expones en el tiempo? Â¿QuÃ© necesitas regular?", "Visualiza el reloj protegido, marcando un ritmo estable."],
                    "cerrado": ["NegaciÃ³n del tiempo", "Resistencia a aceptar el paso del tiempo.", "Â¿Por quÃ© evitas el tiempo? Â¿QuÃ© temes?", "Visualiza el reloj abierto, funcionando con calma."],
                    "flotante": ["DesconexiÃ³n temporal", "EvasiÃ³n del presente.", "Â¿Por quÃ© flota el reloj? Â¿QuÃ© evitas vivir?", "Visualiza el reloj anclado, marcando el ahora."],
                    "hundido": ["DepresiÃ³n temporal", "Peso que estanca el flujo del tiempo.", "Â¿QuÃ© hunde el reloj? Â¿QuÃ© carga llevas?", "Visualiza el reloj emergiendo, marcando un tiempo ligero."],
                    "viejo": ["Nostalgia dolorosa", "Traumas relacionados con el pasado.", "Â¿QuÃ© pasado marca el reloj? Â¿QuÃ© necesitas soltar?", "Visualiza el reloj renovado, marcando un presente libre."],
                    "nuevo": ["RenovaciÃ³n temporal", "Oportunidad para un nuevo comienzo.", "Â¿QuÃ© hora eliges? Â¿QuÃ© comienzas?", "Visualiza el reloj nuevo, marcando un futuro brillante."],
                    "otro": ["Definido por notas", "Trauma personalizado.", "Especifica en notas quÃ© simboliza este estado.", "Visualiza el reloj segÃºn las notas, en un estado ideal de sincronÃ­a."]
                },
                "libro": {
                    "roto": ["Conocimiento fragmentado", "Trauma por secretos no resueltos.", "Â¿QuÃ© pÃ¡ginas faltan? Â¿QuÃ© verdad evitas?", "Visualiza el libro reparado, con todas las respuestas claras."],
                    "sucio": ["SabidurÃ­a nublada", "ConfusiÃ³n por creencias contaminadas.", "Â¿QuÃ© ensucia las pÃ¡ginas? Â¿QuÃ© necesitas limpiar?", "Visualiza el libro limpio, con letras nÃ­tidas."],
                    "limpio": ["Acceso al conocimiento", "Progreso en aceptar verdades internas.", "Â¿QuÃ© lees claramente? Â¿QuÃ© te empodera?", "MantÃ©n el libro limpio, lleno de sabidurÃ­a clara."],
                    "brillante": ["SabidurÃ­a iluminada", "ConexiÃ³n con el inconsciente colectivo.", "Â¿QuÃ© ilumina el libro? Â¿QuÃ© te inspira?", "Visualiza el libro brillando, revelando verdades profundas."],
                    "oscuro": ["Conocimiento reprimido", "Miedo a enfrentar verdades internas.", "Â¿QuÃ© oculta el libro? Â¿QuÃ© temes leer?", "Visualiza el libro iluminado, con pÃ¡ginas claras."],
                    "abierto": ["Receptividad al aprendizaje", "Oportunidad para descubrir verdades.", "Â¿QuÃ© lees? Â¿QuÃ© descubres?", "Visualiza el libro abierto, revelando conocimiento curativo."],
                    "cerrado": ["Bloqueo intelectual", "Resistencia a enfrentar verdades.", "Â¿Por quÃ© estÃ¡ cerrado? Â¿QuÃ© temes leer?", "Visualiza el libro abriÃ©ndose, invitando a la comprensiÃ³n."],
                    "flotante": ["DesconexiÃ³n del conocimiento", "EvasiÃ³n de verdades profundas.", "Â¿Por quÃ© flota el libro? Â¿QuÃ© evitas aprender?", "Visualiza el libro anclado, accesible y claro."],
                    "hundido": ["SabidurÃ­a abrumada", "Peso que oculta el aprendizaje.", "Â¿QuÃ© hunde el libro? Â¿QuÃ© carga llevas?", "Visualiza el libro emergiendo, lleno de claridad."],
                    "viejo": ["Apego al pasado", "Traumas que limitan el aprendizaje.", "Â¿QuÃ© historias guarda el libro? Â¿QuÃ© necesitas soltar?", "Visualiza el libro renovado, con pÃ¡ginas frescas."],
                    "nuevo": ["RenovaciÃ³n del aprendizaje", "Oportunidad para nuevas verdades.", "Â¿QuÃ© escribes en el libro? Â¿QuÃ© comienzas?", "Visualiza el libro nuevo, lleno de posibilidades."],
                    "otro": ["Definido por notas", "Trauma personalizado.", "Especifica en notas quÃ© simboliza este estado.", "Visualiza el libro segÃºn las notas, en un estado ideal de claridad."]
                },
                "rio": {
                    "roto": ["Emociones fragmentadas", "Trauma por rupturas emocionales.", "Â¿QuÃ© rompiÃ³ el flujo? Â¿QuÃ© necesitas unir?", "Visualiza el rÃ­o unido, fluyendo suavemente."],
                    "sucio": ["Emociones reprimidas", "Trauma por acumulaciÃ³n emocional.", "Â¿QuÃ© contamina el rÃ­o? Â¿QuÃ© necesitas soltar?", "Visualiza el rÃ­o limpio, claro y fluido."],
                    "limpio": ["Paz emocional", "Progreso en liberar emociones.", "Â¿QuÃ© te da calma? Â¿QuÃ© fluye libremente?", "MantÃ©n el rÃ­o limpio, fluyendo con paz."],
                    "brillante": ["Flujo vital", "ArmonÃ­a emocional y renovaciÃ³n.", "Â¿QuÃ© ilumina el rÃ­o? Â¿QuÃ© te revitaliza?", "Visualiza el rÃ­o brillando, lleno de vida."],
                    "oscuro": ["Emociones reprimidas", "Miedo a sentir profundamente.", "Â¿QuÃ© oscurece el rÃ­o? Â¿QuÃ© temes sentir?", "Visualiza el rÃ­o iluminado, fluyendo con claridad."],
                    "abierto": ["Libertad emocional", "Receptividad a sentimientos profundos.", "Â¿QuÃ© fluye libremente? Â¿QuÃ© aceptas?", "Visualiza el rÃ­o abierto, llevando emociones positivas."],
                    "cerrado": ["Emociones bloqueadas", "Resistencia a sentir.", "Â¿Por quÃ© estÃ¡ estancado? Â¿QuÃ© temes liberar?", "Visualiza el rÃ­o abriÃ©ndose, fluyendo libremente."],
                    "flotante": ["DesconexiÃ³n emocional", "EvasiÃ³n de sentimientos profundos.", "Â¿Por quÃ© flota el rÃ­o? Â¿QuÃ© evitas sentir?", "Visualiza el rÃ­o anclado, conectado a tus emociones."],
                    "hundido": ["DepresiÃ³n emocional", "Peso que estanca el flujo.", "Â¿QuÃ© hunde el rÃ­o? Â¿QuÃ© carga llevas?", "Visualiza el rÃ­o emergiendo, ligero y claro."],
                    "viejo": ["Emociones antiguas", "Traumas emocionales del pasado.", "Â¿QuÃ© pasado guarda el rÃ­o? Â¿QuÃ© necesitas soltar?", "Visualiza el rÃ­o renovado, fluyendo en el presente."],
                    "nuevo": ["RenovaciÃ³n emocional", "Oportunidad para un nuevo flujo.", "Â¿QuÃ© nuevas emociones fluyen? Â¿QuÃ© comienzas?", "Visualiza el rÃ­o nuevo, fluyendo con energÃ­a."],
                    "otro": ["Definido por notas", "Trauma personalizado.", "Especifica en notas quÃ© simboliza este estado.", "Visualiza el rÃ­o segÃºn las notas, en un estado ideal de fluidez."]
                },
                "vela": {
                    "roto": ["Fragilidad espiritual", "Trauma por pÃ©rdida de fe o guÃ­a.", "Â¿QuÃ© rompiÃ³ la vela? Â¿QuÃ© temes perder?", "Visualiza la vela reparada, ardiendo con fuerza."],
                    "sucio": ["Espiritualidad nublada", "ConfusiÃ³n en la conexiÃ³n interna.", "Â¿QuÃ© ensucia la vela? Â¿QuÃ© necesitas limpiar?", "Visualiza la vela limpia, con una llama pura."],
                    "limpio": ["Claridad espiritual", "Progreso en encontrar guÃ­a interna.", "Â¿QuÃ© ilumina la vela? Â¿QuÃ© te da paz?", "MantÃ©n la vela limpia, ardiendo con calma."],
                    "brillante": ["IluminaciÃ³n espiritual", "ConexiÃ³n con el alma.", "Â¿QuÃ© ves en la luz? Â¿QuÃ© te inspira?", "Visualiza la vela brillando intensamente, guiÃ¡ndote."],
                    "oscuro": ["PÃ©rdida de esperanza", "Miedo a la oscuridad interna.", "Â¿QuÃ© apagÃ³ la vela? Â¿QuÃ© temes?", "Visualiza la vela encendida, iluminando tu interior."],
                    "abierto": ["Vulnerabilidad espiritual", "ExposiciÃ³n de la fe interna.", "Â¿QuÃ© expones con la luz? Â¿QuÃ© necesitas proteger?", "Visualiza la vela protegida, con una llama estable."],
                    "cerrado": ["NegaciÃ³n espiritual", "Resistencia a conectar con el alma.", "Â¿Por quÃ© estÃ¡ apagada? Â¿QuÃ© temes sentir?", "Visualiza la vela encendida, conectando con tu espÃ­ritu."],
                    "flotante": ["DesconexiÃ³n espiritual", "EvasiÃ³n de la guÃ­a interna.", "Â¿Por quÃ© flota la vela? Â¿QuÃ© evitas conectar?", "Visualiza la vela anclada, con una llama firme."],
                    "hundido": ["DepresiÃ³n espiritual", "Peso que apaga la luz interna.", "Â¿QuÃ© hunde la vela? Â¿QuÃ© carga llevas?", "Visualiza la vela emergiendo, ardiendo con claridad."],
                    "viejo": ["Fe agotada", "Traumas espirituales antiguos.", "Â¿QuÃ© pasado guarda la vela? Â¿QuÃ© necesitas soltar?", "Visualiza la vela renovada, con una llama fresca."],
                    "nuevo": ["RenovaciÃ³n espiritual", "Oportunidad para una nueva luz.", "Â¿QuÃ© enciende esta vela? Â¿QuÃ© comienzas?", "Visualiza la vela nueva, ardiendo con fuerza."],
                    "otro": ["Definido por notas", "Trauma personalizado.", "Especifica en notas quÃ© simboliza este estado.", "Visualiza la vela segÃºn las notas, en un estado ideal de luz."]
                },
                "puente": {
                    "roto": ["Relaciones fracturadas", "Trauma por conflictos no resueltos.", "Â¿QuÃ© rompiÃ³ el puente? Â¿QuÃ© separa?", "Visualiza el puente reparado, uniendo tus relaciones."],
                    "sucio": ["Conexiones nubladas", "Dificultad para conectar por traumas.", "Â¿QuÃ© ensucia el puente? Â¿QuÃ© necesitas limpiar?", "Visualiza el puente limpio, facilitando conexiones."],
                    "limpio": ["Conexiones claras", "Progreso en fortalecer relaciones.", "Â¿QuÃ© une el puente? Â¿QuÃ© te conecta?", "MantÃ©n el puente limpio, sÃ³lido y accesible."],
                    "brillante": ["Relaciones luminosas", "ArmonÃ­a en conexiones internas y externas.", "Â¿QuÃ© ilumina el puente? Â¿QuÃ© te une?", "Visualiza el puente brillando, fortaleciendo lazos."],
                    "oscuro": ["Aislamiento relacional", "Miedo a conectar con otros.", "Â¿QuÃ© oscurece el puente? Â¿QuÃ© temes unir?", "Visualiza el puente iluminado, conectando con claridad."],
                    "abierto": ["ConexiÃ³n libre", "Receptividad a relaciones profundas.", "Â¿QuÃ© une el puente? Â¿QuÃ© aceptas?", "Visualiza el puente abierto, facilitando conexiones."],
                    "cerrado": ["Aislamiento protector", "Miedo a conectar con el otro lado.", "Â¿Por quÃ© estÃ¡ cerrado? Â¿QuÃ© temes cruzar?", "Visualiza el puente abriÃ©ndose, seguro para conectar."],
                    "flotante": ["DesconexiÃ³n relacional", "EvasiÃ³n de vÃ­nculos profundos.", "Â¿Por quÃ© flota el puente? Â¿QuÃ© evitas conectar?", "Visualiza el puente anclada, uniendo con firmeza."],
                    "hundido": ["Colapso relacional", "Peso que impide conexiones.", "Â¿QuÃ© hunde el puente? Â¿QuÃ© carga llevas?", "Visualiza el puente emergiendo, sÃ³lido y claro."],
                    "viejo": ["Relaciones antiguas", "Traumas en vÃ­nculos pasados.", "Â¿QuÃ© pasado guarda el puente? Â¿QuÃ© necesitas soltar?", "Visualiza el puente renovado, conectando el presente."],
                    "nuevo": ["RenovaciÃ³n relacional", "Oportunidad para nuevos lazos.", "Â¿QuÃ© une este puente? Â¿QuÃ© comienzas?", "Visualiza el puente nuevo, fortaleciendo conexiones."],
                    "otro": ["Definido por notas", "Trauma personalizado.", "Especifica en notas quÃ© simboliza este estado.", "Visualiza el puente segÃºn las notas, en un estado ideal de uniÃ³n."]
                },
                "llave": {
                    "roto": ["FrustraciÃ³n", "PÃ©rdida de acceso a soluciones.", "Â¿QuÃ© soluciÃ³n perdiste? Â¿QuÃ© necesitas recuperar?", "Visualiza una llave nueva, desbloqueando oportunidades."],
                    "sucio": ["Bloqueos", "Trauma por soluciones estancadas.", "Â¿QuÃ© te bloquea? Â¿QuÃ© necesitas pulir?", "Visualiza la llave limpia, pulida, abriendo con facilidad."],
                    "limpio": ["Acceso claro", "Progreso en encontrar soluciones.", "Â¿QuÃ© abre esta llave? Â¿QuÃ© te empodera?", "MantÃ©n la llave limpia, lista para desbloquear."],
                    "brillante": ["Oportunidades luminosas", "ConexiÃ³n con soluciones claras.", "Â¿QuÃ© ilumina la llave? Â¿QuÃ© te inspira?", "Visualiza la llave brillando, abriendo caminos claros."],
                    "oscuro": ["Secretos ocultos", "Miedo a desbloquear verdades.", "Â¿QuÃ© oculta la llave? Â¿QuÃ© temes abrir?", "Visualiza la llave iluminada, desbloqueando con confianza."],
                    "abierto": ["Acceso libre", "Receptividad a soluciones.", "Â¿QuÃ© abre esta llave? Â¿QuÃ© aceptas?", "Visualiza la llave funcionando, abriendo puertas libremente."],
                    "cerrado": ["Bloqueo defensivo", "Resistencia a desbloquear.", "Â¿Por quÃ© no abre? Â¿QuÃ© temes liberar?", "Visualiza la llave girando, abriendo con seguridad."],
                    "flotante": ["DesconexiÃ³n de soluciones", "EvasiÃ³n de respuestas claras.", "Â¿Por quÃ© flota la llave? Â¿QuÃ© evitas desbloquear?", "Visualiza la llave anclada, lista para abrir."],
                    "hundido": ["PÃ©rdida de acceso", "Peso que bloquea soluciones.", "Â¿QuÃ© hunde la llave? Â¿QuÃ© carga llevas?", "Visualiza la llave emergiendo, lista para desbloquear."],
                    "viejo": ["Secretos antiguos", "Traumas que bloquean el acceso.", "Â¿QuÃ© pasado guarda la llave? Â¿QuÃ© necesitas soltar?", "Visualiza la llave renovada, abriendo el presente."],
                    "nuevo": ["Oportunidades", "Oportunidad para nuevas soluciones.", "Â¿QuÃ© abre esta llave? Â¿QuÃ© comienzas?", "Visualiza la llave nueva, desbloqueando un futuro brillante."],
                    "otro": ["Definido por notas", "Trauma personalizado.", "Especifica en notas quÃ© simboliza este estado.", "Visualiza la llave segÃºn las notas, en un estado ideal de acceso."]
                },
                "coche": {
                    "roto": ["PÃ©rdida de control", "Trauma por estancamiento o accidentes.", "Â¿QuÃ© rompiÃ³ el coche? Â¿A dÃ³nde no llegas?", "Visualiza el coche reparado, avanzando con confianza."],
                    "sucio": ["Desorden vital", "ConfusiÃ³n en el rumbo de vida.", "Â¿QuÃ© ensucia el coche? Â¿QuÃ© necesitas limpiar?", "Visualiza el coche limpio, listo para el viaje."],
                    "limpio": ["DirecciÃ³n clara", "Progreso en el control del rumbo.", "Â¿A dÃ³nde te lleva el coche? Â¿QuÃ© te empodera?", "MantÃ©n el coche limpio, avanzando con claridad."],
                    "brillante": ["AutonomÃ­a luminosa", "ConexiÃ³n con el viaje personal.", "Â¿QuÃ© ilumina el coche? Â¿QuÃ© te impulsa?", "Visualiza el coche brillando, en ruta al Ã©xito."],
                    "oscuro": ["Miedo al rumbo", "Trauma por pÃ©rdida de direcciÃ³n.", "Â¿QuÃ© oscurece el coche? Â¿QuÃ© temes?", "Visualiza el coche iluminado, avanzando con confianza."],
                    "abierto": ["Vulnerabilidad en el viaje", "ExposiciÃ³n excesiva en el rumbo.", "Â¿QuÃ© expones en el viaje? Â¿QuÃ© necesitas proteger?", "Visualiza el coche protegido, avanzando con seguridad."],
                    "cerrado": ["Bloqueo del rumbo", "Resistencia a avanzar.", "Â¿Por quÃ© estÃ¡ detenido? Â¿QuÃ© temes?", "Visualiza el coche abierto, listo para moverse."],
                    "flotante": ["DesconexiÃ³n del rumbo", "EvasiÃ³n del camino personal.", "Â¿Por quÃ© flota el coche? Â¿QuÃ© evitas avanzar?", "Visualiza el coche anclada, en un camino firme."],
                    "hundido": ["Estancamiento vital", "Peso que impide avanzar.", "Â¿QuÃ© hunde el coche? Â¿QuÃ© carga llevas?", "Visualiza el coche emergiendo, listo para avanzar."],
                    "viejo": ["Carga del pasado", "Traumas que frenan el rumbo.", "Â¿QuÃ© pasado guarda el coche? Â¿QuÃ© necesitas soltar?", "Visualiza el coche renovado, avanzando en el presente."],
                    "nuevo": ["RenovaciÃ³n del rumbo", "Oportunidad para un nuevo camino.", "Â¿QuÃ© abre esta puerta? Â¿QuÃ© comienzas?", "Visualiza el coche nuevo, avanzando con energÃ­a."],
                    "otro": ["Definido por notas", "Trauma personalizado.", "Especifica en notas quÃ© simboliza este estado.", "Visualiza el coche segÃºn las notas, en un estado ideal de movimiento."]
                },
                "casa": {
                    "roto": ["Inestabilidad interna", "Trauma por inseguridad en el hogar o yo.", "Â¿QuÃ© rompiÃ³ la casa? Â¿QuÃ© te desestabiliza?", "Visualiza la casa reparada, fuerte y acogedora."],
                    "sucio": ["Carga emocional", "Traumas acumulados en el yo.", "Â¿QuÃ© ensucia la casa? Â¿QuÃ© necesitas limpiar?", "Visualiza la casa limpia, como un santuario."],
                    "limpio": ["Seguridad interna", "Progreso en construir un yo sÃ³lido.", "Â¿QuÃ© te da paz? Â¿QuÃ© te fortalece?", "MantÃ©n la casa limpia, acogiendo tu fuerza interior."],
                    "brillante": ["IntegraciÃ³n del yo", "ArmonÃ­a interna y seguridad.", "Â¿QuÃ© ilumina la casa? Â¿QuÃ© te fortalece?", "Visualiza la casa brillando, llena de paz."],
                    "oscuro": ["Aislamiento interno", "Miedo a conectar con el yo.", "Â¿QuÃ© oscurece la casa? Â¿QuÃ© temes?", "Visualiza la casa iluminada, acogedora y clara."],
                    "abierto": ["Vulnerabilidad interna", "ExposiciÃ³n del yo a influencias externas.", "Â¿QuÃ© expones en la casa? Â¿QuÃ© necesitas proteger?", "Visualiza la casa abierta, pero protegida, acogiendo positividad."],
                    "cerrado": ["Aislamiento protector", "Miedo a abrirte al mundo.", "Â¿Por quÃ© estÃ¡ cerrada? Â¿QuÃ© temes?", "Visualiza la casa abriÃ©ndose, recibiendo energÃ­a positiva."],
                    "flotante": ["DesconexiÃ³n del yo", "EvasiÃ³n de la estabilidad interna.", "Â¿Por quÃ© flota la casa? Â¿QuÃ© evitas anclar?", "Visualiza la casa anclada, sÃ³lida y segura."],
                    "hundido": ["DepresiÃ³n interna", "Peso que colapsa el yo.", "Â¿QuÃ© hunde la casa? Â¿QuÃ© carga llevas?", "Visualiza la casa emergiendo, fuerte y clara."],
                    "viejo": ["Carga familiar", "Traumas heredados del pasado.", "Â¿QuÃ© pasado guarda la casa? Â¿QuÃ© necesitas soltar?", "Visualiza la casa renovada, acogiendo el presente."],
                    "nuevo": ["RenovaciÃ³n del yo", "Oportunidad para un nuevo hogar interno.", "Â¿QuÃ© construyes en esta casa? Â¿QuÃ© comienzas?", "Visualiza la casa nueva, llena de paz y fuerza."],
                    "otro": ["Definido por notas", "Trauma personalizado.", "Especifica en notas quÃ© simboliza este estado.", "Visualiza la casa segÃºn las notas, en un estado ideal de seguridad."]
                }
            };
            const colors = {
                "dorado": ["Divinidad, integraciÃ³n total", "Â¿QuÃ© te hace sentir valioso? Visualiza brillar."],
                "negro": ["Sombra, misterio, introspecciÃ³n profunda", "Â¿QuÃ© te hace sentir aislado? Imagina aÃ±adir luz."],
                "blanco": ["Pureza, claridad, nuevo comienzo", "Â¿QuÃ© te da paz? Reinicia el pasado."],
                "rojo": ["PasiÃ³n, urgencia, emociones intensas", "Â¿QuÃ© te hace sentir intenso? Visualiza calmar."],
                "azul": ["Calma, estabilidad, serenidad", "Â¿QuÃ© te da tranquilidad? Estabiliza."],
                "rosa": ["Amor propio, vulnerabilidad, afecto", "Â¿QuÃ© te hace sentir vulnerable? AÃ±ade afecto."],
                "violeta": ["TransformaciÃ³n, espiritualidad", "Â¿QuÃ© te conecta con lo profundo? Transforma."],
                "verde": ["Crecimiento, conexiÃ³n con la naturaleza", "Â¿QuÃ© te hace crecer? Conecta con la vida."],
                "amarillo": ["IntuiciÃ³n, iluminaciÃ³n", "Â¿QuÃ© te inspira? Visualiza claridad."],
                "gris": ["Neutralidad, ambigÃ¼edad", "Â¿QuÃ© te confunde? Busca claridad."],
                "naranja": ["Creatividad, entusiasmo", "Â¿QuÃ© te energiza? Amplifica esa energÃ­a."],
                "marron": ["Estabilidad, raÃ­ces terrenales", "Â¿QuÃ© te ancla? Fortalece tus raÃ­ces."]
            };
            const textures = {
                "lisa": ["ArmonÃ­a, fluidez emocional", "Â¿QuÃ© te hace sentir en paz? Suaviza la superficie."],
                "aspera": ["Conflictos internos, heridas no sanadas", "Â¿QuÃ© conflicto te irrita? Pule la aspereza."],
                "pegajosa": ["Apegos emocionales, codependencia", "Â¿QuÃ© te mantiene atado? Limpia la pegajosidad."],
                "fria": ["DesconexiÃ³n emocional, aislamiento", "Â¿QuÃ© te hace sentir distante? AÃ±ade calor."],
                "caliente": ["PasiÃ³n restaurada, vitalidad", "Â¿QuÃ© te da energÃ­a vital? Infunde calor."],
                "suave": ["Receptividad, calma", "Â¿QuÃ© te calma? MantÃ©n la suavidad."],
                "dura": ["Rigidez defensiva", "Â¿QuÃ© te endurece? Suaviza tu interior."],
                "humeda": ["Emociones fluidas", "Â¿QuÃ© emociones fluyen? Acepta el flujo."],
                "seca": ["Aridez espiritual", "Â¿QuÃ© te dejÃ³ seco? Hidrata tu alma."],
                "brillante": ["Claridad, energÃ­a", "Â¿QuÃ© te ilumina? Amplifica la luz."],
                "opaca": ["ConfusiÃ³n, bloqueo", "Â¿QuÃ© te nubla? Busca claridad."]
            };
            const sizes = {
                "minusculo": ["Insignificancia, inseguridad", "Â¿QuÃ© te hace sentir pequeÃ±o? Visualiza agrandar."],
                "pequeÃ±o": ["MinimizaciÃ³n, modestia", "Â¿QuÃ© minimizas? Ajusta la perspectiva."],
                "mediano": ["Equilibrio, estabilidad", "Â¿QuÃ© te mantiene en balance? MantÃ©n el equilibrio."],
                "grande": ["Abrumador, ego inflado", "Â¿QuÃ© te abruma? Visualiza reducir."],
                "gigante": ["Amenaza amplificada", "Â¿QuÃ© te parece inmenso? Redimensiona."]
            };
            const tips = [
                "Agradecimiento al cuerpo: Dedica 2-3 min diarios a agradecer a tu corazÃ³n, pulmones, etc., diciendo: 'Gracias por sostenerme'. Visualiza gratitud para sanar.",
                "ManifestaciÃ³n en presente: Repite 2 min al dÃ­a afirmaciones como 'Soy paz'. Siente que ya es real para reprogramar creencias.",
                "RespiraciÃ³n cuadrada: Inhala 4 seg, reten 4, exhala 4, reten 4. Repite 5-10 veces (3-5 min) visualizando disolver tensiones.",
                "VisualizaciÃ³n de luz sanadora: Visualiza 3-5 min luz dorada entrando por tu coronilla, disolviendo dolores emocionales como niebla al sol.",
                "Afirmaciones con espejo: MÃ­rate al espejo 1-2 min, di 'Soy amor, soy luz'. Siente las palabras resonar para sanar autoestima.",
                "RespiraciÃ³n chamÃ¡nica: Inhala 4 seg, reten 4, exhala 4, libera humo negro. Repite 10 veces (2-3 min) para limpiar energÃ­as estancadas.",
                "Diario de gratitud: Escribe 5 min cada noche 3 gratitudes y una herida a liberar, visualizÃ¡ndola como flor que crece.",
                "VisualizaciÃ³n de guÃ­as: Dedica 3-5 min a imaginar un guÃ­a (animal, luz) que te ayuda a sanar. Pregunta: 'Â¿QuÃ© necesito liberar?'.",
                "ManifestaciÃ³n con agua: Infunde un vaso de agua con 'Esta agua limpia mis heridas' (2 min). BÃ©belo visualizando purificaciÃ³n.",
                "CÃ­rculo de luz: Visualiza 3-5 min un cÃ­rculo de luz protectora, diciendo: 'Estoy sanado, estoy completo' para integrar sanaciÃ³n."
            ];

            // Llenar selects para anÃ¡lisis y visualizaciÃ³n
            function loadAthleteSelects() {
                console.log("Cargando selects de deportistas");
                const athletes = getAthletes();
                const analysisSelect = document.getElementById("athleteIdForAnalysis");
                const viewSelect = document.getElementById("viewAthlete");
                if (analysisSelect && viewSelect) {
                    analysisSelect.innerHTML = "<option value=''>-- Elegir --</option>";
                    viewSelect.innerHTML = "<option value=''>-- Elegir Deportista --</option>";
                    athletes.forEach(athlete => {
                        const optionAnalysis = document.createElement("option");
                        optionAnalysis.value = athlete.id;
                        optionAnalysis.text = `${athlete.nombre} ${athlete.apellidos}`;
                        analysisSelect.appendChild(optionAnalysis);
                        const optionView = document.createElement("option");
                        optionView.value = athlete.id;
                        optionView.text = `${athlete.nombre} ${athlete.apellidos}`;
                        viewSelect.appendChild(optionView);
                    });
                } else {
                    console.error("Selects de deportistas no encontrados");
                }
            }

            // Obtener deportistas
            function getAthletes() {
                return JSON.parse(localStorage.getItem("athletes")) || [];
            }

            // Guardar deportista
            const athleteForm = document.getElementById("athleteForm");
            if (athleteForm) {
                athleteForm.addEventListener("submit", function(e) {
                    e.preventDefault();
                    console.log("Guardando deportista");
                    const athlete = {
                        id: Date.now().toString(),
                        nombre: document.getElementById("nombre").value,
                        apellidos: document.getElementById("apellidos").value,
                        telefono: document.getElementById("telefono").value,
                        mail: document.getElementById("mail").value,
                        deporte: document.getElementById("deporte").value,
                        fecha_nacimiento: document.getElementById("fecha_nacimiento").value,
                        hora_nacimiento: document.getElementById("hora_nacimiento").value,
                        analyses: []
                    };
                    let athletes = getAthletes();
                    athletes.push(athlete);
                    localStorage.setItem("athletes", JSON.stringify(athletes));
                    loadAthletes();
                    loadAthleteSelects();
                    athleteForm.reset();
                    alert("Deportista guardado.");
                });
            } else {
                console.error("Elemento athleteForm no encontrado.");
            }

            // Cargar tabla deportistas con ediciÃ³n inline
            function loadAthletes() {
                console.log("Cargando tabla de deportistas");
                const tableBody = document.getElementById("athletesTable")?.querySelector("tbody");
                if (!tableBody) {
                    console.error("Tabla de deportistas no encontrada");
                    return;
                }
                tableBody.innerHTML = "";
                const athletes = getAthletes();
                athletes.forEach(athlete => {
                    const row = document.createElement("tr");
                    row.innerHTML = `
                        <td>${athlete.id}</td>
                        <td>
                            <span class="display">${athlete.nombre}</span>
                            <input type="text" class="edit-field" id="edit-nombre-${athlete.id}" value="${athlete.nombre}">
                        </td>
                        <td>
                            <span class="display">${athlete.apellidos}</span>
                            <input type="text" class="edit-field" id="edit-apellidos-${athlete.id}" value="${athlete.apellidos}">
                        </td>
                        <td>
                            <span class="display">${athlete.telefono}</span>
                            <input type="tel" class="edit-field" id="edit-telefono-${athlete.id}" value="${athlete.telefono}">
                        </td>
                        <td>
                            <span class="display">${athlete.mail}</span>
                            <input type="email" class="edit-field" id="edit-mail-${athlete.id}" value="${athlete.mail}">
                        </td>
                        <td>
                            <span class="display">${athlete.deporte}</span>
                            <input type="text" class="edit-field" id="edit-deporte-${athlete.id}" value="${athlete.deporte}">
                        </td>
                        <td>
                            <span class="display">${athlete.fecha_nacimiento}</span>
                            <input type="date" class="edit-field" id="edit-fecha_nacimiento-${athlete.id}" value="${athlete.fecha_nacimiento}">
                        </td>
                        <td>
                            <span class="display">${athlete.hora_nacimiento}</span>
                            <input type="time" class="edit-field" id="edit-hora_nacimiento-${athlete.id}" value="${athlete.hora_nacimiento}">
                        </td>
                        <td>${athlete.analyses.length}</td>
                        <td>
                            <button class="edit-btn" onclick="toggleEdit('${athlete.id}', 'nombre')">âœï¸</button>
                            <button class="edit-btn" onclick="toggleEdit('${athlete.id}', 'apellidos')">âœï¸</button>
                            <button class="edit-btn" onclick="toggleEdit('${athlete.id}', 'telefono')">âœï¸</button>
                            <button class="edit-btn" onclick="toggleEdit('${athlete.id}', 'mail')">âœï¸</button>
                            <button class="edit-btn" onclick="toggleEdit('${athlete.id}', 'deporte')">âœï¸</button>
                            <button class="edit-btn" onclick="toggleEdit('${athlete.id}', 'fecha_nacimiento')">âœï¸</button>
                            <button class="edit-btn" onclick="toggleEdit('${athlete.id}', 'hora_nacimiento')">âœï¸</button>
                            <button class="save-btn hidden" id="save-${athlete.id}" onclick="saveEdit('${athlete.id}')">Guardar</button>
                            <button class="delete-btn" onclick="deleteAthlete('${athlete.id}')">ğŸ—‘ï¸</button>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
            }

            // EdiciÃ³n inline
            function toggleEdit(id, field) {
                console.log(`Editando campo ${field} para ID ${id}`);
                const display = document.querySelector(`#athletesTable tr td:nth-child(${field === 'nombre' ? 2 : field === 'apellidos' ? 3 : field === 'telefono' ? 4 : field === 'mail' ? 5 : field === 'deporte' ? 6 : field === 'fecha_nacimiento' ? 7 : 8}) .display`);
                const input = document.getElementById(`edit-${field}-${id}`);
                const saveBtn = document.getElementById(`save-${id}`);
                if (display && input && saveBtn) {
                    display.style.display = display.style.display === 'none' ? 'inline' : 'none';
                    input.style.display = input.style.display === 'none' ? 'inline' : 'none';
                    saveBtn.classList.toggle('hidden');
                } else {
                    console.error("Elementos para ediciÃ³n no encontrados", { display, input, saveBtn });
                }
            }

            function saveEdit(id) {
                console.log(`Guardando ediciÃ³n para ID ${id}`);
                const athletes = getAthletes();
                const athlete = athletes.find(a => a.id === id);
                if (athlete) {
                    athlete.nombre = document.getElementById(`edit-nombre-${id}`).value || athlete.nombre;
                    athlete.apellidos = document.getElementById(`edit-apellidos-${id}`).value || athlete.apellidos;
                    athlete.telefono = document.getElementById(`edit-telefono-${id}`).value || athlete.telefono;
                    athlete.mail = document.getElementById(`edit-mail-${id}`).value || athlete.mail;
                    athlete.deporte = document.getElementById(`edit-deporte-${id}`).value || athlete.deporte;
                    athlete.fecha_nacimiento = document.getElementById(`edit-fecha_nacimiento-${id}`).value || athlete.fecha_nacimiento;
                    athlete.hora_nacimiento = document.getElementById(`edit-hora_nacimiento-${id}`).value || athlete.hora_nacimiento;
                    localStorage.setItem("athletes", JSON.stringify(athletes));
                    loadAthletes();
                    loadAthleteSelects();
                    alert("Deportista actualizado.");
                }
            }

            // Eliminar deportista
            function deleteAthlete(id) {
                console.log(`Eliminando deportista ID ${id}`);
                if (confirm("Â¿EstÃ¡s seguro de que quieres eliminar este deportista y todos sus anÃ¡lisis?")) {
                    let athletes = getAthletes();
                    athletes = athletes.filter(a => a.id !== id);
                    localStorage.setItem("athletes", JSON.stringify(athletes));
                    loadAthletes();
                    loadAthleteSelects();
                    alert("Deportista eliminado.");
                }
            }

            // AnÃ¡lisis de objeto
            const analysisForm = document.getElementById("analysisForm");
            if (analysisForm) {
                analysisForm.addEventListener("submit", function(e) {
                    e.preventDefault();
                    console.log("Formulario de anÃ¡lisis enviado");
                    const athleteId = document.getElementById("athleteIdForAnalysis").value;
                    if (!athleteId) {
                        console.error("Deportista no seleccionado");
                        alert("Selecciona un deportista.");
                        return;
                    }
                    const obj = document.getElementById("objeto").value;
                    const st = document.getElementById("estado").value;
                    const col = document.getElementById("color").value;
                    const tex = document.getElementById("textura").value;
                    const siz = document.getElementById("tamaÃ±o").value;
                    const notas = document.getElementById("notas_estado").value;
                    if (!obj || !st || !col || !tex || !siz) {
                        console.error("Campos de anÃ¡lisis incompletos", { obj, st, col, tex, siz });
                        alert("Completa todos los campos del anÃ¡lisis.");
                        return;
                    }
                    if (st === "otro" && !notas) {
                        console.error("Notas requeridas para estado 'otro'");
                        alert("Especifica notas para el estado 'Otro'.");
                        return;
                    }
                    // Generar anÃ¡lisis
                    const psique = objects[obj] || "No encontrado";
                    const stateData = states[obj] && states[obj][st] ? states[obj][st] : ["Definido por notas", "Trauma personalizado.", "Especifica en notas quÃ© simboliza este estado.", "Visualiza el objeto segÃºn las notas, en un estado ideal."];
                    const stateInterp = stateData[0];
                    const stateTrauma = stateData[1];
                    const stateQuestions = stateData[2];
                    const stateHealing = stateData[3];
                    const colorData = colors[col] || ["No encontrado", ""];
                    const colorInterp = colorData[0];
                    const colorQuestions = colorData[1];
                    const textureData = textures[tex] || ["No encontrado", ""];
                    const textureInterp = textureData[0];
                    const textureQuestions = textureData[1];
                    const sizeData = sizes[siz] || ["No encontrado", ""];
                    const sizeInterp = sizeData[0];
                    const sizeQuestions = sizeData[1];
                    const symbolism = `El ${obj} (${psique}) en estado ${st}${notas ? ` (${notas})` : ""} simboliza ${stateInterp.toLowerCase()}, influenciado por el color ${col} (${colorInterp.toLowerCase()}), la textura ${tex} (${textureInterp.toLowerCase()}) y el tamaÃ±o ${siz} (${sizeInterp.toLowerCase()}). Representa un aspecto de ${psique.toLowerCase()} en el inconsciente.`;
                    const trauma = `Posible trauma: ${stateTrauma} Modificado por ${colorInterp.toLowerCase()} (e.g., ${colorQuestions.split('?')[0]}?), con sensaciÃ³n de ${textureInterp.toLowerCase()} (e.g., ${textureQuestions.split('?')[0]}?) y percepciÃ³n de ${sizeInterp.toLowerCase()} (e.g., ${sizeQuestions.split('?')[0]}?). En la vida, esto puede manifestarse como ${stateInterp.toLowerCase()} en ${psique.toLowerCase()}. En el deporte, afecta el rendimiento por ${stateTrauma.toLowerCase()}.`;
                    const questions = `Preguntas para explorar: ${stateQuestions} ${colorQuestions} ${textureQuestions} ${sizeQuestions}${notas ? ` Â¿CÃ³mo describe las notas este estado?` : ""}`;
                    const healing = notas && st === "otro" ? `Visualiza el ${obj} segÃºn las notas: ${notas}, en un estado ideal (limpio, entero, brillante, equilibrado).` : stateHealing;
                    // Asignar tip
                    const athletes = getAthletes();
                    const athleteIndex = athletes.findIndex(a => a.id === athleteId);
                    const tipIndex = athleteIndex !== -1 && athletes[athleteIndex].analyses ? athletes[athleteIndex].analyses.length % 10 : 0;
                    const tip = tips[tipIndex];
                    // Guardar anÃ¡lisis
                    if (athleteIndex !== -1) {
                        const analysis = {
                            objeto: obj,
                            estado: st,
                            color: col,
                            textura: tex,
                            tamaÃ±o: siz,
                            notas: notas,
                            simbolismo: symbolism,
                            trauma: trauma,
                            preguntas: questions,
                            sanacion: healing,
                            tip: tip,
                            fecha: new Date().toISOString()
                        };
                        athletes[athleteIndex].analyses.push(analysis);
                        localStorage.setItem("athletes", JSON.stringify(athletes));
                        loadAthletes();
                        loadAthleteSelects();
                        alert("AnÃ¡lisis guardado para el deportista.");
                    } else {
                        console.error("Deportista no encontrado para ID", athleteId);
                        alert("Error: Deportista no encontrado.");
                        return;
                    }
                    // Mostrar resultado
                    document.getElementById("analysisOutput").innerHTML = `
                        <h4>AnÃ¡lisis Guardado para ${athletes[athleteIndex].nombre} ${athletes[athleteIndex].apellidos}:</h4>
                        <p><strong>RepresentaciÃ³n/Simbolismo:</strong> ${symbolism}</p>
                        <p><strong>Significado y Trauma:</strong> ${trauma}</p>
                        <p><strong>Preguntas para Explorar:</strong> ${questions}</p>
                        <p><strong>CÃ³mo Sanarlo:</strong> ${healing}</p>
                        <p><strong>Tarea Diaria (Tip):</strong> ${tip}</p>
                    `;
                });
            } else {
                console.error("Elemento analysisForm no encontrado.");
            }

            // Cargar anÃ¡lisis por deportista
            function loadAnalyses() {
                console.log("Cargando anÃ¡lisis de deportista");
                const athleteId = document.getElementById("viewAthlete").value;
                const tableBody = document.getElementById("analysesTable")?.querySelector("tbody");
                const table = document.getElementById("analysesTable");
                if (!tableBody || !table) {
                    console.error("Tabla de anÃ¡lisis no encontrada");
                    return;
                }
                table.classList.add("hidden");
                tableBody.innerHTML = "";
                if (athleteId) {
                    const athletes = getAthletes();
                    const athlete = athletes.find(a => a.id === athleteId);
                    if (athlete && athlete.analyses.length > 0) {
                        athlete.analyses.forEach(analysis => {
                            const row = document.createElement("tr");
                            row.innerHTML = `
                                <td>${analysis.objeto}</td>
                                <td>${analysis.estado}${analysis.notas ? ` (${analysis.notas})` : ""}</td>
                                <td>${analysis.color}</td>
                                <td>${analysis.textura}</td>
                                <td>${analysis.tamaÃ±o}</td>
                                <td>${analysis.simbolismo.substring(0, 50)}...</td>
                                <td>${analysis.trauma.substring(0, 50)}...</td>
                                <td>${new Date(analysis.fecha).toLocaleDateString()}</td>
                            `;
                            tableBody.appendChild(row);
                        });
                        table.classList.remove("hidden");
                    } else {
                        console.error("No hay anÃ¡lisis para deportista ID", athleteId);
                        alert("No hay anÃ¡lisis para este deportista.");
                    }
                }
            }

            // Exportar a CSV
            function exportData() {
                console.log("Exportando datos a CSV");
                const athletes = getAthletes();
                let csv = "ID,Nombre,Apellidos,Telefono,Email,Deporte,Fecha Nacimiento,Hora Nacimiento,Objeto,Estado,Notas,Color,Textura,TamaÃ±o,Simbolismo,Trauma,Preguntas,Sanacion,Tip,Fecha AnÃ¡lisis\n";
                athletes.forEach(athlete => {
                    if (athlete.analyses && athlete.analyses.length > 0) {
                        athlete.analyses.forEach(analysis => {
                            csv += `"${athlete.id}","${athlete.nombre}","${athlete.apellidos}","${athlete.telefono}","${athlete.mail}","${athlete.deporte}","${athlete.fecha_nacimiento}","${athlete.hora_nacimiento}","${analysis.objeto}","${analysis.estado}","${analysis.notas ? analysis.notas.replace(/"/g, '""') : ''}","${analysis.color}","${analysis.textura}","${analysis.tamaÃ±o}","${analysis.simbolismo.replace(/"/g, '""')}","${analysis.trauma.replace(/"/g, '""')}","${analysis.preguntas.replace(/"/g, '""')}","${analysis.sanacion.replace(/"/g, '""')}","${analysis.tip.replace(/"/g, '""')}","${analysis.fecha}"\n";
                        });
                    } else {
                        csv += `"${athlete.id}","${athlete.nombre}","${athlete.apellidos}","${athlete.telefono}","${athlete.mail}","${athlete.deporte}","${athlete.fecha_nacimiento}","${athlete.hora_nacimiento}","","","","","","","","","",""\n";
                    }
                });
                const blob = new Blob([csv], { type: "text/csv" });
                const url = URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = "mindsight_datos_completos.csv";
                a.click();
                alert("Datos exportados como CSV. Ãbrelo en Excel para anÃ¡lisis.");
            }
        });
    </script>
</body>
</html>