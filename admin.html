```html
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Admin - MindSight Elite 360</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; }
        #login, #dashboard { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        form { display: flex; flex-direction: column; }
        label { margin: 10px 0 5px; }
        input, select, button { padding: 10px; margin-bottom: 10px; }
        #output { margin-top: 20px; padding: 10px; background: #e0f7fa; border: 1px solid #00acc1; }
        #deportistas, #analyses { margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background: #f2f2f2; }
        .hidden { display: none; }
        button { background: #007cba; color: white; border: none; cursor: pointer; }
        button:hover { background: #005a87; }
    </style>
</head>
<body>

    <div id="login">
        <h2>Login Admin</h2>
        <form id="loginForm">
            <label for="username">Usuario:</label>
            <input type="text" id="username" required>
            <label for="password">Contraseña:</label>
            <input type="password" id="password" required>
            <button type="submit">Ingresar</button>
        </form>
    </div>

    <div id="dashboard" class="hidden">
        <h2>Dashboard Admin - MindSight Elite 360</h2>
        
        <!-- Formulario para Datos de Deportista -->
        <h3>Agregar Deportista</h3>
        <form id="athleteForm">
            <label for="nombre">Nombre:</label>
            <input type="text" id="nombre" required>
            <label for="apellidos">Apellidos:</label>
            <input type="text" id="apellidos" required>
            <label for="telefono">Teléfono:</label>
            <input type="tel" id="telefono" required>
            <label for="mail">Email:</label>
            <input type="email" id="mail" required>
            <label for="deporte">Deporte:</label>
            <input type="text" id="deporte" required>
            <label for="fecha_nacimiento">Fecha de Nacimiento (YYYY-MM-DD):</label>
            <input type="date" id="fecha_nacimiento" required>
            <label for="hora_nacimiento">Hora de Nacimiento (HH:MM):</label>
            <input type="time" id="hora_nacimiento" required>
            <button type="submit">Guardar Deportista</button>
        </form>

        <!-- Formulario para Editar Deportista -->
        <h3>Editar Deportista</h3>
        <form id="editAthleteForm">
            <label for="editId">Seleccionar Deportista por ID:</label>
            <select id="editId" required>
                <option value="">-- Elegir --</option>
            </select>
            <label for="editNombre">Nombre:</label>
            <input type="text" id="editNombre">
            <label for="editApellidos">Apellidos:</label>
            <input type="text" id="editApellidos">
            <label for="editTelefono">Teléfono:</label>
            <input type="tel" id="editTelefono">
            <label for="editMail">Email:</label>
            <input type="email" id="editMail">
            <label for="editDeporte">Deporte:</label>
            <input type="text" id="editDeporte">
            <label for="editFechaNacimiento">Fecha de Nacimiento:</label>
            <input type="date" id="editFechaNacimiento">
            <label for="editHoraNacimiento">Hora de Nacimiento:</label>
            <input type="time" id="editHoraNacimiento">
            <button type="submit">Actualizar Deportista</button>
        </form>

        <!-- Lista de Deportistas Guardados -->
        <h3>Deportistas Registrados</h3>
        <table id="athletesTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre Completo</th>
                    <th>Teléfono</th>
                    <th>Email</th>
                    <th>Deporte</th>
                    <th>Fecha Nacimiento</th>
                    <th>Hora Nacimiento</th>
                    <th>Análisis Realizados</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <!-- Formulario para Análisis de Objeto (vinculado a deportista) -->
        <h3>Análisis de Objeto (Vinculado a Deportista)</h3>
        <form id="analysisForm">
            <label for="athleteIdForAnalysis">Seleccionar Deportista:</label>
            <select id="athleteIdForAnalysis" required>
                <option value="">-- Elegir --</option>
            </select>
            <label for="objeto">Objeto:</label>
            <select id="objeto" required>
                <option value="espejo">Espejo</option>
                <option value="puerta">Puerta</option>
                <option value="reloj">Reloj</option>
                <option value="libro">Libro</option>
                <option value="rio">Río</option>
                <option value="vela">Vela</option>
                <option value="puente">Puente</option>
                <option value="llave">Llave</option>
                <option value="coche">Coche</option>
                <option value="casa">Casa</option>
            </select>
            <label for="estado">Estado:</label>
            <select id="estado" required>
                <!-- Opciones se llenan dinámicamente -->
            </select>
            <label for="color">Color:</label>
            <select id="color" required>
                <option value="dorado">Dorado</option>
                <option value="negro">Negro</option>
                <option value="blanco">Blanco</option>
                <option value="rojo">Rojo</option>
                <option value="azul">Azul</option>
                <option value="rosa">Rosa</option>
                <option value="violeta">Violeta</option>
            </select>
            <label for="textura">Textura:</label>
            <select id="textura" required>
                <option value="lisa">Lisa</option>
                <option value="aspera">Áspera</option>
                <option value="pegajosa">Pegajosa</option>
                <option value="fria">Fría</option>
                <option value="caliente">Caliente</option>
            </select>
            <label for="tamaño">Tamaño:</label>
            <select id="tamaño" required>
                <option value="pequeño">Pequeño</option>
                <option value="mediano">Mediano</option>
                <option value="grande">Grande</option>
            </select>
            <button type="submit">Analizar y Guardar</button>
        </form>
        <div id="analysisOutput"></div>

        <!-- Tabla de Análisis por Deportista -->
        <h3>Análisis por Deportista</h3>
        <select id="viewAthlete" onchange="loadAnalyses()">
            <option value="">-- Elegir Deportista --</option>
        </select>
        <table id="analysesTable" class="hidden">
            <thead>
                <tr>
                    <th>Objeto</th>
                    <th>Estado</th>
                    <th>Color</th>
                    <th>Textura</th>
                    <th>Tamaño</th>
                    <th>Simbolismo</th>
                    <th>Trauma</th>
                    <th>Fecha Análisis</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <!-- Botones de Acción -->
        <button onclick="exportData()">Exportar Datos (CSV)</button>
        <button onclick="logout()">Cerrar Sesión</button>
    </div>

    <script>
        // Datos para análisis (completo)
        const objects = {
            "espejo": "Ego/Auto-percepción",
            "puerta": "Transiciones/Cambio",
            "reloj": "Relación con el Tiempo",
            "libro": "Infancia/Aprendizaje",
            "rio": "Emociones/Flujo",
            "vela": "Esperanza/Espiritualidad",
            "puente": "Relaciones/Conexiones",
            "llave": "Acceso/Secretos",
            "coche": "Autonomía/Independencia",
            "casa": "Familia/Hogar Interno"
        };

        const states = {
            "espejo": {
                "nuevo": ["Confianza en la autoimagen", "¿Qué te hace sentir seguro? Usa esa confianza."],
                "roto": ["Autoimagen dañada, trauma", "¿Qué dañó cómo te ves? Imagina reparar el espejo."],
                "sucio": ["Confusión sobre la identidad", "¿Qué te impide verte claro? Visualiza limpiar."],
                "antiguo": ["Apego al pasado", "¿Qué recuerdo define tu autoimagen? Reescribe."]
            },
            "puerta": {
                "abierta": ["Disposición al cambio", "¿Qué te motiva a avanzar? Usa esa energía."],
                "cerrada": ["Miedo al cambio, resistencia", "¿Qué te frena? Visualiza abrir la puerta."],
                "rota": ["Obstáculos en transiciones", "¿Qué bloqueó un cambio? Repara la puerta."],
                "sólida": ["Seguridad en decisiones", "¿Qué te da estabilidad? Usa esa fuerza."]
            },
            "reloj": {
                "funcionando": ["Control sobre el tiempo", "¿Qué te da control? Usa eso."],
                "parado": ["Estancamiento", "¿Qué te atrapó? Hazlo funcionar."],
                "roto": ["Ansiedad por el tiempo", "¿Qué rompió el tiempo? Repara el reloj."],
                "antiguo": ["Nostalgia", "¿Qué pasado revisitas? Imagina futuro."]
            },
            "libro": {
                "nuevo": ["Curiosidad infantil", "¿Qué te emociona aprender? Usa eso."],
                "desgastado": ["Experiencias vividas", "¿Qué recuerdos guardas?"],
                "páginas en blanco": ["Potencial, incertidumbre", "¿Qué escribes? Crea una historia."],
                "roto": ["Trauma infantil", "¿Qué se rompió en tu niñez? Reescribe."]
            },
            "rio": {
                "tranquilo": ["Paz emocional", "¿Qué te calma? Usa eso."],
                "turbulento": ["Conflictos emocionales", "¿Qué te abruma? Calma el río."],
                "seco": ["Agotamiento emocional", "¿Qué te dejó vacío? Llena el río."],
                "desbordado": ["Abrumado", "¿Qué te desborda? Estabiliza."]
            },
            "vela": {
                "encendida": ["Esperanza", "¿Qué te ilumina? Usa esa luz."],
                "apagada": ["Pérdida de motivación", "¿Qué apagó tu luz? Enciéndela."],
                "derritiéndose": ["Agotamiento", "¿Qué te consume? Protege la vela."],
                "intacta": ["Potencial", "¿Qué esperas para encender?"]
            },
            "puente": {
                "sólido": ["Conexiones fuertes", "¿Qué relaciones te sostienen?"],
                "inestable": ["Inseguridad en relaciones", "¿Qué relación es frágil? Repara."],
                "en construcción": ["Esfuerzo por conectar", "¿Qué construyes en relaciones?"],
                "antiguo": ["Vínculos pasados", "¿Qué vínculo pasado influye? Actualiza."]
            },
            "llave": {
                "nueva": ["Oportunidades", "¿Qué abres? Usa eso."],
                "oxidada": ["Bloqueos", "¿Qué te bloquea? Pule la llave."],
                "rota": ["Frustración", "¿Qué solución perdiste? Nueva llave."],
                "antigua": ["Secretos del pasado", "¿Qué secreto desbloqueas? Usa la llave."]
            },
            "coche": {
                "nuevo": ["Confianza", "¿A dónde te lleva tu autonomía?"],
                "averiado": ["Obstáculos", "¿Qué te frena? Repara el coche."],
                "viejo": ["Resiliencia", "¿Qué te dio fuerza? Imagina nuevo."],
                "sin combustible": ["Agotamiento", "¿Qué te dejó sin energía? Recarga."]
            },
            "casa": {
                "sólida": ["Seguridad", "¿Qué te da paz? Usa eso."],
                "en ruinas": ["Trauma familiar", "¿Qué se rompió en tu familia? Reconstruye."],
                "en construcción": ["Crecimiento", "¿Qué reconstruyes?"],
                "vacía": ["Soledad", "¿Qué ausencia sientes? Llena la casa."]
            }
        };

        const colors = {
            "dorado": ["Autoestima alta, éxito, valor", "¿Qué te hace sentir valioso? Visualiza brillar."],
            "negro": ["Aislamiento, misterio, introspección profunda", "¿Qué te hace sentir oscuro o aislado? Imagina añadir luz."],
            "blanco": ["Claridad, pureza, nuevo comienzo", "¿Qué te da paz o simplicidad? Reinicio del pasado."],
            "rojo": ["Pasión, urgencia, emociones intensas", "¿Qué te hace sentir intenso? Visualiza calmar."],
            "azul": ["Calma, estabilidad, serenidad", "¿Qué te da tranquilidad? Estabiliza."],
            "rosa": ["Amor propio, vulnerabilidad, necesidad de afecto", "¿Qué te hace sentir vulnerable? Añade afecto."],
            "violeta": ["Introspección, transformación, espiritualidad", "¿Qué te conecta con lo profundo? Transforma."]
        };

        const textures = {
            "lisa": ["Armonía, fluidez emocional, confianza restaurada", "¿Qué te hace sentir en paz? Suaviza la superficie."],
            "aspera": ["Conflictos internos, resistencia, heridas no sanadas", "¿Qué conflicto te irrita? Pule la aspereza."],
            "pegajosa": ["Apegos emocionales, emociones estancadas, codependencia", "¿Qué te mantiene atado? Limpia la pegajosidad."],
            "fria": ["Desconexión emocional, miedo, aislamiento", "¿Qué te hace sentir distante? Añade calor."],
            "caliente": ["Conexión emocional, pasión restaurada, vitalidad", "¿Qué te da energía vital? Infunde calor."]
        };

        const sizes = {
            "pequeño": ["Minimización, inseguridad, sentimiento de insignificancia", "¿Qué te hace sentir insuficiente? Visualiza agrandar."],
            "mediano": ["Equilibrio, estabilidad emocional, neutralidad", "¿Qué te mantiene en balance? Ajusta para dinamismo."],
            "grande": ["Abrumador, presión, importancia exagerada", "¿Qué te abruma? Visualiza reducir."]
        };

        const tips = [
            "Agradecimiento al cuerpo: Dedica 2-3 min diarios a agradecer a tu corazón, pulmones, etc., diciendo: 'Gracias por sostenerme'. Visualiza gratitud para sanar.",
            "Manifestación en presente: Repite 2 min al día afirmaciones como 'Soy paz'. Siente que ya es real para reprogramar creencias.",
            "Respiración cuadrada: Inhala 4 seg, reten 4, exhala 4, reten 4. Repite 5-10 veces (3-5 min) visualizando disolver tensiones.",
            "Visualización de luz sanadora: Visualiza 3-5 min luz dorada entrando por tu coronilla, disolviendo dolores emocionales como niebla al sol.",
            "Afirmaciones con espejo: Mírate al espejo 1-2 min, di 'Soy amor, soy luz'. Siente las palabras resonar para sanar autoestima.",
            "Respiración chamánica: Inhala 4 seg, reten 4, exhala 4, libera humo negro. Repite 10 veces (2-3 min) para limpiar energías estancadas.",
            "Diario de gratitud: Escribe 5 min cada noche 3 gratitudes y una herida a liberar, visualizándola como flor que crece.",
            "Visualización de guías: Dedica 3-5 min a imaginar un guía (animal, luz) que te ayuda a sanar. Pregunta: '¿Qué necesito liberar?'.",
            "Manifestación con agua: Infunde un vaso de agua con 'Esta agua limpia mis heridas' (2 min). Bébelo visualizando purificación.",
            "Círculo de luz: Visualiza 3-5 min un círculo de luz protectora, diciendo: 'Estoy sanado, estoy completo' para integrar sanación."
        ];

        // Login simple
        const adminUser = "admin";
        const adminPass = "mindsight123";

        document.getElementById("loginForm").addEventListener("submit", function(e) {
            e.preventDefault();
            const user = document.getElementById("username").value;
            const pass = document.getElementById("password").value;
            if (user === adminUser && pass === adminPass) {
                document.getElementById("login").classList.add("hidden");
                document.getElementById("dashboard").classList.remove("hidden");
                loadAthletes();
                loadAthleteSelects();
            } else {
                alert("Usuario o contraseña incorrectos.");
            }
        });

        function logout() {
            document.getElementById("dashboard").classList.add("hidden");
            document.getElementById("login").classList.remove("hidden");
        }

        // Actualizar estados según objeto
        document.getElementById("objeto").addEventListener("change", function() {
            const objeto = this.value;
            const estadoSelect = document.getElementById("estado");
            estadoSelect.innerHTML = "<option value=''>-- Selecciona --</option>";
            if (states[objeto]) {
                Object.keys(states[objeto]).forEach(state => {
                    const option = document.createElement("option");
                    option.value = state;
                    option.text = state.charAt(0).toUpperCase() + state.slice(1);
                    estadoSelect.appendChild(option);
                });
            }
        });

        // Disparar cambio inicial
        document.getElementById("objeto").dispatchEvent(new Event("change"));

        // Llenar selects para editar, análisis y visualización
        function loadAthleteSelects() {
            const athletes = getAthletes();
            const editSelect = document.getElementById("editId");
            const analysisSelect = document.getElementById("athleteIdForAnalysis");
            const viewSelect = document.getElementById("viewAthlete");
            editSelect.innerHTML = "<option value=''>-- Elegir --</option>";
            analysisSelect.innerHTML = "<option value=''>-- Elegir --</option>";
            viewSelect.innerHTML = "<option value=''>-- Elegir Deportista --</option>";
            athletes.forEach(athlete => {
                const optionEdit = document.createElement("option");
                optionEdit.value = athlete.id;
                optionEdit.text = `${athlete.nombre} ${athlete.apellidos}`;
                editSelect.appendChild(optionEdit);

                const optionAnalysis = document.createElement("option");
                optionAnalysis.value = athlete.id;
                optionAnalysis.text = `${athlete.nombre} ${athlete.apellidos}`;
                analysisSelect.appendChild(optionAnalysis);

                const optionView = document.createElement("option");
                optionView.value = athlete.id;
                optionView.text = `${athlete.nombre} ${athlete.apellidos}`;
                viewSelect.appendChild(optionView);
            });
        }

        // Get Athletes from localStorage
        function getAthletes() {
            return JSON.parse(localStorage.getItem("athletes")) || [];
        }

        // Athlete Form - Save to localStorage with ID
        document.getElementById("athleteForm").addEventListener("submit", function(e) {
            e.preventDefault();
            const athlete = {
                id: Date.now().toString(),
                nombre: document.getElementById("nombre").value,
                apellidos: document.getElementById("apellidos").value,
                telefono: document.getElementById("telefono").value,
                mail: document.getElementById("mail").value,
                deporte: document.getElementById("deporte").value,
                fecha_nacimiento: document.getElementById("fecha_nacimiento").value,
                hora_nacimiento: document.getElementById("hora_nacimiento").value,
                analyses: []
            };
            let athletes = getAthletes();
            athletes.push(athlete);
            localStorage.setItem("athletes", JSON.stringify(athletes));
            loadAthletes();
            loadAthleteSelects();
            document.getElementById("athleteForm").reset();
            alert("Deportista guardado.");
        });

        // Edit Athlete Form
        document.getElementById("editAthleteForm").addEventListener("submit", function(e) {
            e.preventDefault();
            const id = document.getElementById("editId").value;
            if (!id) {
                alert("Selecciona un deportista.");
                return;
            }
            let athletes = getAthletes();
            const athlete = athletes.find(a => a.id === id);
            if (athlete) {
                athlete.nombre = document.getElementById("editNombre").value || athlete.nombre;
                athlete.apellidos = document.getElementById("editApellidos").value || athlete.apellidos;
                athlete.telefono = document.getElementById("editTelefono").value || athlete.telefono;
                athlete.mail = document.getElementById("editMail").value || athlete.mail;
                athlete.deporte = document.getElementById("editDeporte").value || athlete.deporte;
                athlete.fecha_nacimiento = document.getElementById("editFechaNacimiento").value || athlete.fecha_nacimiento;
                athlete.hora_nacimiento = document.getElementById("editHoraNacimiento").value || athlete.hora_nacimiento;
                localStorage.setItem("athletes", JSON.stringify(athletes));
                loadAthletes();
                loadAthleteSelects();
                document.getElementById("editAthleteForm").reset();
                alert("Deportista actualizado.");
            }
        });

        // Llenar formulario de edición
        document.getElementById("editId").addEventListener("change", function() {
            const id = this.value;
            if (id) {
                const athletes = getAthletes();
                const athlete = athletes.find(a => a.id === id);
                if (athlete) {
                    document.getElementById("editNombre").value = athlete.nombre;
                    document.getElementById("editApellidos").value = athlete.apellidos;
                    document.getElementById("editTelefono").value = athlete.telefono;
                    document.getElementById("editMail").value = athlete.mail;
                    document.getElementById("editDeporte").value = athlete.deporte;
                    document.getElementById("editFechaNacimiento").value = athlete.fecha_nacimiento;
                    document.getElementById("editHoraNacimiento").value = athlete.hora_nacimiento;
                }
            }
        });

        // Load Athletes Table
        function loadAthletes() {
            const tableBody = document.getElementById("athletesTable").querySelector("tbody");
            tableBody.innerHTML = "";
            const athletes = getAthletes();
            athletes.forEach(athlete => {
                const row = document.createElement("tr");
                row.innerHTML = `
                    <td>${athlete.id}</td>
                    <td>${athlete.nombre} ${athlete.apellidos}</td>
                    <td>${athlete.telefono}</td>
                    <td>${athlete.mail}</td>
                    <td>${athlete.deporte}</td>
                    <td>${athlete.fecha_nacimiento}</td>
                    <td>${athlete.hora_nacimiento}</td>
                    <td>${athlete.analyses.length}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Analysis Form - Vinculado a deportista
        document.getElementById("analysisForm").addEventListener("submit", function(e) {
            e.preventDefault();
            const athleteId = document.getElementById("athleteIdForAnalysis").value;
            if (!athleteId) {
                alert("Selecciona un deportista.");
                return;
            }
            const obj = document.getElementById("objeto").value;
            const st = document.getElementById("estado").value;
            const col = document.getElementById("color").value;
            const tex = document.getElementById("textura").value;
            const siz = document.getElementById("tamaño").value;

            // Generar análisis
            const psique = objects[obj] || "No encontrado";
            const stateData = states[obj] ? states[obj][st] : null;
            const stateInterp = stateData ? stateData[0] : "No encontrado";
            const stateGuide = stateData ? stateData[1] : "";
            const colorData = colors[col] || ["No encontrado", ""];
            const colorInterp = colorData[0];
            const colorGuide = colorData[1];
            const textureData = textures[tex] || ["No encontrado", ""];
            const textureInterp = textureData[0];
            const textureGuide = textureData[1];
            const sizeData = sizes[siz] || ["No encontrado", ""];
            const sizeInterp = sizeData[0];
            const sizeGuide = sizeData[1];

            const symbolism = `El ${obj} (${psique}) en estado ${st} (${stateInterp}) con color ${col} (${colorInterp}), textura ${tex} (${textureInterp}) y tamaño ${siz} (${sizeInterp}) simboliza una combinación de ${stateInterp.toLowerCase()} influenciada por ${colorInterp.toLowerCase()}, ${textureInterp.toLowerCase()} y ${sizeInterp.toLowerCase()}. Esto representa un trauma emocional relacionado con ${psique.toLowerCase()}.`;

            const trauma = `Posible trauma: ${stateInterp} agravado por ${colorInterp.toLowerCase()} (e.g., ${colorGuide.split('?')[0]}?), con sensación de ${textureInterp.toLowerCase()} (e.g., ${textureGuide.split('?')[0]}?) y percepción de ${sizeInterp.toLowerCase()} (e.g., ${sizeGuide.split('?')[0]}?). En la vida general, esto puede causar ${sizeInterp.toLowerCase()} en ${psique.toLowerCase()}, como inseguridad o abrumo. En deporte, afecta rendimiento por ${stateInterp.toLowerCase()} emocional, e.g., dudas en decisiones.`;

            const questions = `Preguntas para explorar: ${stateGuide} ${colorGuide} ${textureGuide} ${sizeGuide}`;

            const healing = `Cómo sanarlo: Libera el trauma con respiración cuadrada (inhala 4 seg, reten 4, exhala 4, reten 4) y gratitud al cuerpo ('Gracias, corazón, por latir'). Re-visualiza el ${obj} en su forma perfecta: nuevo o intacto, color dorado (éxito), textura lisa y caliente (armonía y conexión), tamaño mediano (equilibrio), limpio, reluciente, con marco u orilla dorada reflejando victoria y confianza. Por ejemplo, si es un espejo, imagina su superficie cristalina, cálida, reflejando tu rostro lleno de paz; si es un río, visualiza aguas tranquilas, doradas, fluyendo suavemente. Integra afirmaciones: 'Soy ${psique.toLowerCase()} equilibrado y poderoso'.`;

            // Asignar tip según número de análisis
            const athletes = getAthletes();
            const athleteIndex = athletes.findIndex(a => a.id === athleteId);
            const tipIndex = athleteIndex !== -1 && athletes[athleteIndex].analyses ? athletes[athleteIndex].analyses.length % 10 : 0;
            const tip = tips[tipIndex];

            // Guardar análisis
            if (athleteIndex !== -1) {
                const analysis = {
                    objeto: obj,
                    estado: st,
                    color: col,
                    textura: tex,
                    tamaño: siz,
                    simbolismo: symbolism,
                    trauma: trauma,
                    preguntas: questions,
                    sanacion: healing,
                    tip: tip,
                    fecha: new Date().toISOString()
                };
                athletes[athleteIndex].analyses.push(analysis);
                localStorage.setItem("athletes", JSON.stringify(athletes));
                loadAthletes();
                loadAnalyses();
                alert("Análisis guardado para el deportista.");
            }

            // Mostrar resultado
            document.getElementById("analysisOutput").innerHTML = `
                <h4>Análisis Guardado para ${athletes[athleteIndex].nombre} ${athletes[athleteIndex].apellidos}:</h4>
                <p><strong>Representación/Simbolismo:</strong> ${symbolism}</p>
                <p><strong>Significado y Trauma:</strong> ${trauma}</p>
                <p><strong>Preguntas para Explorar:</strong> ${questions}</p>
                <p><strong>Cómo Sanarlo:</strong> ${healing}</p>
                <p><strong>Tarea Diaria (Tip):</strong> ${tip}</p>
            `;
        });

        // Load Analyses for Selected Athlete
        function loadAnalyses() {
            const athleteId = document.getElementById("viewAthlete").value;
            const tableBody = document.getElementById("analysesTable").querySelector("tbody");
            const table = document.getElementById("analysesTable");
            table.classList.add("hidden");
            tableBody.innerHTML = "";
            if (athleteId) {
                const athletes = getAthletes();
                const athlete = athletes.find(a => a.id === athleteId);
                if (athlete && athlete.analyses.length > 0) {
                    athlete.analyses.forEach(analysis => {
                        const row = document.createElement("tr");
                        row.innerHTML = `
                            <td>${analysis.objeto}</td>
                            <td>${analysis.estado}</td>
                            <td>${analysis.color}</td>
                            <td>${analysis.textura}</td>
                            <td>${analysis.tamaño}</td>
                            <td>${analysis.simbolismo.substring(0, 50)}...</td>
                            <td>${analysis.trauma.substring(0, 50)}...</td>
                            <td>${new Date(analysis.fecha).toLocaleDateString()}</td>
                        `;
                        tableBody.appendChild(row);
                    });
                    table.classList.remove("hidden");
                } else {
                    alert("No hay análisis para este deportista.");
                }
            }
        }

        // Export Data to CSV
        function exportData() {
            const athletes = getAthletes();
            let csv = "ID,Nombre,Apellidos,Telefono,Email,Deporte,Fecha Nacimiento,Hora Nacimiento,Objeto,Estado,Color,Textura,Tamaño,Simbolismo,Trauma,Preguntas,Sanacion,Tip,Fecha Análisis\n";
            athletes.forEach(athlete => {
                if (athlete.analyses && athlete.analyses.length > 0) {
                    athlete.analyses.forEach(analysis => {
                        csv += `"${athlete.id}","${athlete.nombre}","${athlete.apellidos}","${athlete.telefono}","${athlete.mail}","${athlete.deporte}","${athlete.fecha_nacimiento}","${athlete.hora_nacimiento}","${analysis.objeto}","${analysis.estado}","${analysis.color}","${analysis.textura}","${analysis.tamaño}","${analysis.simbolismo.replace(/"/g, '""')}","${analysis.trauma.replace(/"/g, '""')}","${analysis.preguntas.replace(/"/g, '""')}","${analysis.sanacion.replace(/"/g, '""')}","${analysis.tip.replace(/"/g, '""')}","${analysis.fecha}"\n`;
                    });
                } else {
                    csv += `"${athlete.id}","${athlete.nombre}","${athlete.apellidos}","${athlete.telefono}","${athlete.mail}","${athlete.deporte}","${athlete.fecha_nacimiento}","${athlete.hora_nacimiento}","","","","","","","","","",""\n`;
                }
            });
            const blob = new Blob([csv], { type: "text/csv" });
            const url = URL.createObjectURL(blob);
            const a = document.createElement("a");
            a.href = url;
            a.download = "mindsight_datos_completos.csv";
            a.click();
            alert("Datos exportados como CSV. Ábrelo en Excel para análisis.");
        }
    </script>

</body>
</html>
```