```ultima
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Admin - MindSight Elite 360</title>
    <style>
        body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; }
        #login, #dashboard { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
        form { display: flex; flex-direction: column; }
        label { margin: 10px 0 5px; }
        input, select, button { padding: 10px; margin-bottom: 10px; }
        #output { margin-top: 20px; padding: 10px; background: #e0f7fa; border: 1px solid #00acc1; }
        #deportistas, #analyses { margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background: #f2f2f2; }
        .hidden { display: none; }
        button { background: #007cba; color: white; border: none; cursor: pointer; }
        button:hover { background: #005a87; }
        button.edit-btn, button.delete-btn, button.save-btn { padding: 5px; font-size: 12px; margin-right: 5px; }
        .edit-btn { background: #4CAF50; }
        .delete-btn { background: #f44336; }
        .save-btn { background: #2196F3; }
        input.edit-field { display: none; width: 100%; }
    </style>
</head>
<body>

    <div id="login">
        <h2>Login Admin</h2>
        <form id="loginForm">
            <label for="username">Usuario:</label>
            <input type="text" id="username" required>
            <label for="password">Contrase√±a:</label>
            <input type="password" id="password" required>
            <button type="submit">Ingresar</button>
        </form>
    </div>

    <div id="dashboard" class="hidden">
        <h2>Dashboard Admin - MindSight Elite 360</h2>
        
        <!-- Formulario para Datos de Deportista -->
        <h3>Agregar Deportista</h3>
        <form id="athleteForm">
            <label for="nombre">Nombre:</label>
            <input type="text" id="nombre" required>
            <label for="apellidos">Apellidos:</label>
            <input type="text" id="apellidos" required>
            <label for="telefono">Tel√©fono:</label>
            <input type="tel" id="telefono" required>
            <label for="mail">Email:</label>
            <input type="email" id="mail" required>
            <label for="deporte">Deporte:</label>
            <input type="text" id="deporte" required>
            <label for="fecha_nacimiento">Fecha de Nacimiento (YYYY-MM-DD):</label>
            <input type="date" id="fecha_nacimiento" required>
            <label for="hora_nacimiento">Hora de Nacimiento (HH:MM):</label>
            <input type="time" id="hora_nacimiento" required>
            <button type="submit">Guardar Deportista</button>
        </form>

        <!-- Lista de Deportistas Guardados -->
        <h3>Deportistas Registrados</h3>
        <table id="athletesTable">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Nombre</th>
                    <th>Apellidos</th>
                    <th>Tel√©fono</th>
                    <th>Email</th>
                    <th>Deporte</th>
                    <th>Fecha Nacimiento</th>
                    <th>Hora Nacimiento</th>
                    <th>An√°lisis</th>
                    <th>Acciones</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <!-- Formulario para An√°lisis de Objeto -->
        <h3>An√°lisis de Objeto (Vinculado a Deportista)</h3>
        <form id="analysisForm">
            <label for="athleteIdForAnalysis">Seleccionar Deportista:</label>
            <select id="athleteIdForAnalysis" required>
                <option value="">-- Elegir --</option>
            </select>
            <label for="objeto">Objeto:</label>
            <select id="objeto" required>
                <option value="espejo">Espejo</option>
                <option value="puerta">Puerta</option>
                <option value="reloj">Reloj</option>
                <option value="libro">Libro</option>
                <option value="rio">R√≠o</option>
                <option value="vela">Vela</option>
                <option value="puente">Puente</option>
                <option value="llave">Llave</option>
                <option value="coche">Coche</option>
                <option value="casa">Casa</option>
            </select>
            <label for="estado">Estado:</label>
            <select id="estado" required>
                <!-- Opciones din√°micas -->
            </select>
            <label for="color">Color:</label>
            <select id="color" required>
                <option value="dorado">Dorado</option>
                <option value="negro">Negro</option>
                <option value="blanco">Blanco</option>
                <option value="rojo">Rojo</option>
                <option value="azul">Azul</option>
                <option value="rosa">Rosa</option>
                <option value="violeta">Violeta</option>
            </select>
            <label for="textura">Textura:</label>
            <select id="textura" required>
                <option value="lisa">Lisa</option>
                <option value="aspera">√Åspera</option>
                <option value="pegajosa">Pegajosa</option>
                <option value="fria">Fr√≠a</option>
                <option value="caliente">Caliente</option>
            </select>
            <label for="tama√±o">Tama√±o:</label>
            <select id="tama√±o" required>
                <option value="peque√±o">Peque√±o</option>
                <option value="mediano">Mediano</option>
                <option value="grande">Grande</option>
            </select>
            <button type="submit">Analizar y Guardar</button>
        </form>
        <div id="analysisOutput"></div>

        <!-- Tabla de An√°lisis por Deportista -->
        <h3>An√°lisis por Deportista</h3>
        <select id="viewAthlete" onchange="loadAnalyses()">
            <option value="">-- Elegir Deportista --</option>
        </select>
        <table id="analysesTable" class="hidden">
            <thead>
                <tr>
                    <th>Objeto</th>
                    <th>Estado</th>
                    <th>Color</th>
                    <th>Textura</th>
                    <th>Tama√±o</th>
                    <th>Simbolismo</th>
                    <th>Trauma</th>
                    <th>Fecha An√°lisis</th>
                </tr>
            </thead>
            <tbody></tbody>
        </table>

        <!-- Botones -->
        <button onclick="exportData()">Exportar Datos (CSV)</button>
        <button onclick="logout()">Cerrar Sesi√≥n</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Datos para an√°lisis
            const objects = {
                "espejo": "Ego/Auto-percepci√≥n",
                "puerta": "Transiciones/Cambio",
                "reloj": "Relaci√≥n con el Tiempo",
                "libro": "Infancia/Aprendizaje",
                "rio": "Emociones/Flujo",
                "vela": "Esperanza/Espiritualidad",
                "puente": "Relaciones/Conexiones",
                "llave": "Acceso/Secretos",
                "coche": "Autonom√≠a/Independencia",
                "casa": "Familia/Hogar Interno"
            };

            const states = {
                "espejo": {
                    "nuevo": ["Confianza en la autoimagen", "¬øQu√© te hace sentir seguro? Usa esa confianza."],
                    "roto": ["Autoimagen da√±ada, trauma", "¬øQu√© da√±√≥ c√≥mo te ves? Imagina reparar el espejo."],
                    "sucio": ["Confusi√≥n sobre la identidad", "¬øQu√© te impide verte claro? Visualiza limpiar."],
                    "antiguo": ["Apego al pasado", "¬øQu√© recuerdo define tu autoimagen? Reescribe."]
                },
                "puerta": {
                    "abierta": ["Disposici√≥n al cambio", "¬øQu√© te motiva a avanzar? Usa esa energ√≠a."],
                    "cerrada": ["Miedo al cambio, resistencia", "¬øQu√© te frena? Visualiza abrir la puerta."],
                    "rota": ["Obst√°culos en transiciones", "¬øQu√© bloque√≥ un cambio? Repara la puerta."],
                    "s√≥lida": ["Seguridad en decisiones", "¬øQu√© te da estabilidad? Usa esa fuerza."]
                },
                "reloj": {
                    "funcionando": ["Control sobre el tiempo", "¬øQu√© te da control? Usa eso."],
                    "parado": ["Estancamiento", "¬øQu√© te atrap√≥? Hazlo funcionar."],
                    "roto": ["Ansiedad por el tiempo", "¬øQu√© rompi√≥ el tiempo? Repara el reloj."],
                    "antiguo": ["Nostalgia", "¬øQu√© pasado revisitas? Imagina futuro."]
                },
                "libro": {
                    "nuevo": ["Curiosidad infantil", "¬øQu√© te emociona aprender? Usa eso."],
                    "desgastado": ["Experiencias vividas", "¬øQu√© recuerdos guardas?"],
                    "p√°ginas en blanco": ["Potencial, incertidumbre", "¬øQu√© escribes? Crea una historia."],
                    "roto": ["Trauma infantil", "¬øQu√© se rompi√≥ en tu ni√±ez? Reescribe."]
                },
                "rio": {
                    "tranquilo": ["Paz emocional", "¬øQu√© te calma? Usa eso."],
                    "turbulento": ["Conflictos emocionales", "¬øQu√© te abruma? Calma el r√≠o."],
                    "seco": ["Agotamiento emocional", "¬øQu√© te dej√≥ vac√≠o? Llena el r√≠o."],
                    "desbordado": ["Abrumado", "¬øQu√© te desborda? Estabiliza."]
                },
                "vela": {
                    "encendida": ["Esperanza", "¬øQu√© te ilumina? Usa esa luz."],
                    "apagada": ["P√©rdida de motivaci√≥n", "¬øQu√© apag√≥ tu luz? Enci√©ndela."],
                    "derriti√©ndose": ["Agotamiento", "¬øQu√© te consume? Protege la vela."],
                    "intacta": ["Potencial", "¬øQu√© esperas para encender?"]
                },
                "puente": {
                    "s√≥lido": ["Conexiones fuertes", "¬øQu√© relaciones te sostienen?"],
                    "inestable": ["Inseguridad en relaciones", "¬øQu√© relaci√≥n es fr√°gil? Repara."],
                    "en construcci√≥n": ["Esfuerzo por conectar", "¬øQu√© construyes en relaciones?"],
                    "antiguo": ["V√≠nculos pasados", "¬øQu√© v√≠nculo pasado influye? Actualiza."]
                },
                "llave": {
                    "nueva": ["Oportunidades", "¬øQu√© abres? Usa eso."],
                    "oxidada": ["Bloqueos", "¬øQu√© te bloquea? Pule la llave."],
                    "rota": ["Frustraci√≥n", "¬øQu√© soluci√≥n perdiste? Nueva llave."],
                    "antigua": ["Secretos del pasado", "¬øQu√© secreto desbloqueas? Usa la llave."]
                },
                "coche": {
                    "nuevo": ["Confianza", "¬øA d√≥nde te lleva tu autonom√≠a?"],
                    "averiado": ["Obst√°culos", "¬øQu√© te frena? Repara el coche."],
                    "viejo": ["Resiliencia", "¬øQu√© te dio fuerza? Imagina nuevo."],
                    "sin combustible": ["Agotamiento", "¬øQu√© te dej√≥ sin energ√≠a? Recarga."]
                },
                "casa": {
                    "s√≥lida": ["Seguridad", "¬øQu√© te da paz? Usa eso."],
                    "en ruinas": ["Trauma familiar", "¬øQu√© se rompi√≥ en tu familia? Reconstruye."],
                    "en construcci√≥n": ["Crecimiento", "¬øQu√© reconstruyes?"],
                    "vac√≠a": ["Soledad", "¬øQu√© ausencia sientes? Llena la casa."]
                }
            };

            const colors = {
                "dorado": ["Autoestima alta, √©xito, valor", "¬øQu√© te hace sentir valioso? Visualiza brillar."],
                "negro": ["Aislamiento, misterio, introspecci√≥n profunda", "¬øQu√© te hace sentir oscuro o aislado? Imagina a√±adir luz."],
                "blanco": ["Claridad, pureza, nuevo comienzo", "¬øQu√© te da paz o simplicidad? Reinicio del pasado."],
                "rojo": ["Pasi√≥n, urgencia, emociones intensas", "¬øQu√© te hace sentir intenso? Visualiza calmar."],
                "azul": ["Calma, estabilidad, serenidad", "¬øQu√© te da tranquilidad? Estabiliza."],
                "rosa": ["Amor propio, vulnerabilidad, necesidad de afecto", "¬øQu√© te hace sentir vulnerable? A√±ade afecto."],
                "violeta": ["Introspecci√≥n, transformaci√≥n, espiritualidad", "¬øQu√© te conecta con lo profundo? Transforma."]
            };

            const textures = {
                "lisa": ["Armon√≠a, fluidez emocional, confianza restaurada", "¬øQu√© te hace sentir en paz? Suaviza la superficie."],
                "aspera": ["Conflictos internos, resistencia, heridas no sanadas", "¬øQu√© conflicto te irrita? Pule la aspereza."],
                "pegajosa": ["Apegos emocionales, emociones estancadas, codependencia", "¬øQu√© te mantiene atado? Limpia la pegajosidad."],
                "fria": ["Desconexi√≥n emocional, miedo, aislamiento", "¬øQu√© te hace sentir distante? A√±ade calor."],
                "caliente": ["Conexi√≥n emocional, pasi√≥n restaurada, vitalidad", "¬øQu√© te da energ√≠a vital? Infunde calor."]
            };

            const sizes = {
                "peque√±o": ["Minimizaci√≥n, inseguridad, sentimiento de insignificancia", "¬øQu√© te hace sentir insuficiente? Visualiza agrandar."],
                "mediano": ["Equilibrio, estabilidad emocional, neutralidad", "¬øQu√© te mantiene en balance? Ajusta para dinamismo."],
                "grande": ["Abrumador, presi√≥n, importancia exagerada", "¬øQu√© te abruma? Visualiza reducir."]
            };

            const tips = [
                "Agradecimiento al cuerpo: Dedica 2-3 min diarios a agradecer a tu coraz√≥n, pulmones, etc., diciendo: 'Gracias por sostenerme'. Visualiza gratitud para sanar.",
                "Manifestaci√≥n en presente: Repite 2 min al d√≠a afirmaciones como 'Soy paz'. Siente que ya es real para reprogramar creencias.",
                "Respiraci√≥n cuadrada: Inhala 4 seg, reten 4, exhala 4, reten 4. Repite 5-10 veces (3-5 min) visualizando disolver tensiones.",
                "Visualizaci√≥n de luz sanadora: Visualiza 3-5 min luz dorada entrando por tu coronilla, disolviendo dolores emocionales como niebla al sol.",
                "Afirmaciones con espejo: M√≠rate al espejo 1-2 min, di 'Soy amor, soy luz'. Siente las palabras resonar para sanar autoestima.",
                "Respiraci√≥n cham√°nica: Inhala 4 seg, reten 4, exhala 4, libera humo negro. Repite 10 veces (2-3 min) para limpiar energ√≠as estancadas.",
                "Diario de gratitud: Escribe 5 min cada noche 3 gratitudes y una herida a liberar, visualiz√°ndola como flor que crece.",
                "Visualizaci√≥n de gu√≠as: Dedica 3-5 min a imaginar un gu√≠a (animal, luz) que te ayuda a sanar. Pregunta: '¬øQu√© necesito liberar?'.",
                "Manifestaci√≥n con agua: Infunde un vaso de agua con 'Esta agua limpia mis heridas' (2 min). B√©belo visualizando purificaci√≥n.",
                "C√≠rculo de luz: Visualiza 3-5 min un c√≠rculo de luz protectora, diciendo: 'Estoy sanado, estoy completo' para integrar sanaci√≥n."
            ];

            // Login
            const adminUser = "admin";
            const adminPass = "clave";

            const loginForm = document.getElementById("loginForm");
            if (loginForm) {
                loginForm.addEventListener("submit", function(e) {
                    e.preventDefault();
                    const user = document.getElementById("username").value.trim();
                    const pass = document.getElementById("password").value.trim();
                    if (user === adminUser && pass === adminPass) {
                        document.getElementById("login").classList.add("hidden");
                        document.getElementById("dashboard").classList.remove("hidden");
                        loadAthletes();
                        loadAthleteSelects();
                    } else {
                        alert("Usuario o contrase√±a incorrectos. Usa: admin / mindsight123");
                    }
                });
            } else {
                console.error("Elemento loginForm no encontrado.");
            }

            function logout() {
                document.getElementById("dashboard").classList.add("hidden");
                document.getElementById("login").classList.remove("hidden");
            }

            // Actualizar estados seg√∫n objeto
            const objetoSelect = document.getElementById("objeto");
            if (objetoSelect) {
                objetoSelect.addEventListener("change", function() {
                    const objeto = this.value;
                    const estadoSelect = document.getElementById("estado");
                    estadoSelect.innerHTML = "<option value=''>-- Selecciona --</option>";
                    if (states[objeto]) {
                        Object.keys(states[objeto]).forEach(state => {
                            const option = document.createElement("option");
                            option.value = state;
                            option.text = state.charAt(0).toUpperCase() + state.slice(1);
                            estadoSelect.appendChild(option);
                        });
                    }
                });
                objetoSelect.dispatchEvent(new Event("change"));
            } else {
                console.error("Elemento objeto no encontrado.");
            }

            // Llenar selects para an√°lisis y visualizaci√≥n
            function loadAthleteSelects() {
                const athletes = getAthletes();
                const analysisSelect = document.getElementById("athleteIdForAnalysis");
                const viewSelect = document.getElementById("viewAthlete");
                analysisSelect.innerHTML = "<option value=''>-- Elegir --</option>";
                viewSelect.innerHTML = "<option value=''>-- Elegir Deportista --</option>";
                athletes.forEach(athlete => {
                    const optionAnalysis = document.createElement("option");
                    optionAnalysis.value = athlete.id;
                    optionAnalysis.text = `${athlete.nombre} ${athlete.apellidos}`;
                    analysisSelect.appendChild(optionAnalysis);

                    const optionView = document.createElement("option");
                    optionView.value = athlete.id;
                    optionView.text = `${athlete.nombre} ${athlete.apellidos}`;
                    viewSelect.appendChild(optionView);
                });
            }

            // Obtener deportistas
            function getAthletes() {
                return JSON.parse(localStorage.getItem("athletes")) || [];
            }

            // Guardar deportista
            const athleteForm = document.getElementById("athleteForm");
            if (athleteForm) {
                athleteForm.addEventListener("submit", function(e) {
                    e.preventDefault();
                    const athlete = {
                        id: Date.now().toString(),
                        nombre: document.getElementById("nombre").value,
                        apellidos: document.getElementById("apellidos").value,
                        telefono: document.getElementById("telefono").value,
                        mail: document.getElementById("mail").value,
                        deporte: document.getElementById("deporte").value,
                        fecha_nacimiento: document.getElementById("fecha_nacimiento").value,
                        hora_nacimiento: document.getElementById("hora_nacimiento").value,
                        analyses: []
                    };
                    let athletes = getAthletes();
                    athletes.push(athlete);
                    localStorage.setItem("athletes", JSON.stringify(athletes));
                    loadAthletes();
                    loadAthleteSelects();
                    athleteForm.reset();
                    alert("Deportista guardado.");
                });
            } else {
                console.error("Elemento athleteForm no encontrado.");
            }

            // Cargar tabla deportistas con edici√≥n inline
            function loadAthletes() {
                const tableBody = document.getElementById("athletesTable").querySelector("tbody");
                tableBody.innerHTML = "";
                const athletes = getAthletes();
                athletes.forEach(athlete => {
                    const row = document.createElement("tr");
                    row.innerHTML = `
                        <td>${athlete.id}</td>
                        <td>
                            <span class="display">${athlete.nombre}</span>
                            <input type="text" class="edit-field" id="edit-nombre-${athlete.id}" value="${athlete.nombre}">
                        </td>
                        <td>
                            <span class="display">${athlete.apellidos}</span>
                            <input type="text" class="edit-field" id="edit-apellidos-${athlete.id}" value="${athlete.apellidos}">
                        </td>
                        <td>
                            <span class="display">${athlete.telefono}</span>
                            <input type="tel" class="edit-field" id="edit-telefono-${athlete.id}" value="${athlete.telefono}">
                        </td>
                        <td>
                            <span class="display">${athlete.mail}</span>
                            <input type="email" class="edit-field" id="edit-mail-${athlete.id}" value="${athlete.mail}">
                        </td>
                        <td>
                            <span class="display">${athlete.deporte}</span>
                            <input type="text" class="edit-field" id="edit-deporte-${athlete.id}" value="${athlete.deporte}">
                        </td>
                        <td>
                            <span class="display">${athlete.fecha_nacimiento}</span>
                            <input type="date" class="edit-field" id="edit-fecha_nacimiento-${athlete.id}" value="${athlete.fecha_nacimiento}">
                        </td>
                        <td>
                            <span class="display">${athlete.hora_nacimiento}</span>
                            <input type="time" class="edit-field" id="edit-hora_nacimiento-${athlete.id}" value="${athlete.hora_nacimiento}">
                        </td>
                        <td>${athlete.analyses.length}</td>
                        <td>
                            <button class="edit-btn" onclick="toggleEdit('${athlete.id}', 'nombre')">‚úèÔ∏è</button>
                            <button class="edit-btn" onclick="toggleEdit('${athlete.id}', 'apellidos')">‚úèÔ∏è</button>
                            <button class="edit-btn" onclick="toggleEdit('${athlete.id}', 'telefono')">‚úèÔ∏è</button>
                            <button class="edit-btn" onclick="toggleEdit('${athlete.id}', 'mail')">‚úèÔ∏è</button>
                            <button class="edit-btn" onclick="toggleEdit('${athlete.id}', 'deporte')">‚úèÔ∏è</button>
                            <button class="edit-btn" onclick="toggleEdit('${athlete.id}', 'fecha_nacimiento')">‚úèÔ∏è</button>
                            <button class="edit-btn" onclick="toggleEdit('${athlete.id}', 'hora_nacimiento')">‚úèÔ∏è</button>
                            <button class="save-btn hidden" id="save-${athlete.id}" onclick="saveEdit('${athlete.id}')">Guardar</button>
                            <button class="delete-btn" onclick="deleteAthlete('${athlete.id}')">üóëÔ∏è</button>
                        </td>
                    `;
                    tableBody.appendChild(row);
                });
            }

            // Edici√≥n inline
            function toggleEdit(id, field) {
                const display = document.querySelector(`#athletesTable tr td:nth-child(${field === 'nombre' ? 2 : field === 'apellidos' ? 3 : field === 'telefono' ? 4 : field === 'mail' ? 5 : field === 'deporte' ? 6 : field === 'fecha_nacimiento' ? 7 : 8}) .display`);
                const input = document.getElementById(`edit-${field}-${id}`);
                const saveBtn = document.getElementById(`save-${id}`);
                if (display && input && saveBtn) {
                    display.style.display = display.style.display === 'none' ? 'inline' : 'none';
                    input.style.display = input.style.display === 'none' ? 'inline' : 'none';
                    saveBtn.classList.toggle('hidden');
                }
            }

            function saveEdit(id) {
                const athletes = getAthletes();
                const athlete = athletes.find(a => a.id === id);
                if (athlete) {
                    athlete.nombre = document.getElementById(`edit-nombre-${id}`).value || athlete.nombre;
                    athlete.apellidos = document.getElementById(`edit-apellidos-${id}`).value || athlete.apellidos;
                    athlete.telefono = document.getElementById(`edit-telefono-${id}`).value || athlete.telefono;
                    athlete.mail = document.getElementById(`edit-mail-${id}`).value || athlete.mail;
                    athlete.deporte = document.getElementById(`edit-deporte-${id}`).value || athlete.deporte;
                    athlete.fecha_nacimiento = document.getElementById(`edit-fecha_nacimiento-${id}`).value || athlete.fecha_nacimiento;
                    athlete.hora_nacimiento = document.getElementById(`edit-hora_nacimiento-${id}`).value || athlete.hora_nacimiento;
                    localStorage.setItem("athletes", JSON.stringify(athletes));
                    loadAthletes();
                    loadAthleteSelects();
                    alert("Deportista actualizado.");
                }
            }

            // Eliminar deportista
            function deleteAthlete(id) {
                if (confirm("¬øEst√°s seguro de que quieres eliminar este deportista y todos sus an√°lisis?")) {
                    let athletes = getAthletes();
                    athletes = athletes.filter(a => a.id !== id);
                    localStorage.setItem("athletes", JSON.stringify(athletes));
                    loadAthletes();
                    loadAthleteSelects();
                    alert("Deportista eliminado.");
                }
            }

            // An√°lisis de objeto
            const analysisForm = document.getElementById("analysisForm");
            if (analysisForm) {
                analysisForm.addEventListener("submit", function(e) {
                    e.preventDefault();
                    const athleteId = document.getElementById("athleteIdForAnalysis").value;
                    if (!athleteId) {
                        alert("Selecciona un deportista.");
                        return;
                    }
                    const obj = document.getElementById("objeto").value;
                    const st = document.getElementById("estado").value;
                    const col = document.getElementById("color").value;
                    const tex = document.getElementById("textura").value;
                    const siz = document.getElementById("tama√±o").value;
                    if (!obj || !st || !col || !tex || !siz) {
                        alert("Completa todos los campos del an√°lisis.");
                        return;
                    }

                    // Generar an√°lisis
                    const psique = objects[obj] || "No encontrado";
                    const stateData = states[obj] ? states[obj][st] : null;
                    const stateInterp = stateData ? stateData[0] : "No encontrado";
                    const stateGuide = stateData ? stateData[1] : "";
                    const colorData = colors[col] || ["No encontrado", ""];
                    const colorInterp = colorData[0];
                    const colorGuide = colorData[1];
                    const textureData = textures[tex] || ["No encontrado", ""];
                    const textureInterp = textureData[0];
                    const textureGuide = textureData[1];
                    const sizeData = sizes[siz] || ["No encontrado", ""];
                    const sizeInterp = sizeData[0];
                    const sizeGuide = sizeData[1];

                    const symbolism = `El ${obj} (${psique}) en estado ${st} (${stateInterp}) con color ${col} (${colorInterp}), textura ${tex} (${textureInterp}) y tama√±o ${siz} (${sizeInterp}) simboliza una combinaci√≥n de ${stateInterp.toLowerCase()} influenciada por ${colorInterp.toLowerCase()}, ${textureInterp.toLowerCase()} y ${sizeInterp.toLowerCase()}. Esto representa un trauma emocional relacionado con ${psique.toLowerCase()}.`;

                    const trauma = `Posible trauma: ${stateInterp} agravado por ${colorInterp.toLowerCase()} (e.g., ${colorGuide.split('?')[0]}?), con sensaci√≥n de ${textureInterp.toLowerCase()} (e.g., ${textureGuide.split('?')[0]}?) y percepci√≥n de ${sizeInterp.toLowerCase()} (e.g., ${sizeGuide.split('?')[0]}?). En la vida general, esto puede causar ${sizeInterp.toLowerCase()} en ${psique.toLowerCase()}, como inseguridad o abrumo. En deporte, afecta rendimiento por ${stateInterp.toLowerCase()} emocional, e.g., dudas en decisiones.`;

                    const questions = `Preguntas para explorar: ${stateGuide} ${colorGuide} ${textureGuide} ${sizeGuide}`;

                    const healing = `C√≥mo sanarlo: Re-visualiza el ${obj} en su forma perfecta: ${obj === 'espejo' ? 'nuevo, limpio, reluciente, con marco dorado reflejando un rostro lleno de paz' : obj === 'puerta' ? 'abierta, dorada, lisa, c√°lida, invitando a nuevas oportunidades' : obj === 'reloj' ? 'funcionando, dorado, liso, c√°lido, marcando tiempo en armon√≠a' : obj === 'libro' ? 'nuevo, dorado, liso, c√°lido, con p√°ginas llenas de posibilidades' : obj === 'rio' ? 'tranquilo, dorado, liso, c√°lido, fluyendo suavemente' : obj === 'vela' ? 'encendida, dorada, liso, c√°lida, con llama brillante' : obj === 'puente' ? 's√≥lido, dorado, liso, c√°lido, conectando relaciones fuertes' : obj === 'llave' ? 'nueva, dorada, liso, c√°lida, desbloqueando oportunidades' : obj === 'coche' ? 'nuevo, dorado, liso, c√°lido, avanzando con confianza' : 's√≥lida, dorada, liso, c√°lida, acogiendo paz familiar'}, tama√±o mediano.`;

                    // Asignar tip
                    const athletes = getAthletes();
                    const athleteIndex = athletes.findIndex(a => a.id === athleteId);
                    const tipIndex = athleteIndex !== -1 && athletes[athleteIndex].analyses ? athletes[athleteIndex].analyses.length % 10 : 0;
                    const tip = tips[tipIndex];

                    // Guardar an√°lisis
                    if (athleteIndex !== -1) {
                        const analysis = {
                            objeto: obj,
                            estado: st,
                            color: col,
                            textura: tex,
                            tama√±o: siz,
                            simbolismo: symbolism,
                            trauma: trauma,
                            preguntas: questions,
                            sanacion: healing,
                            tip: tip,
                            fecha: new Date().toISOString()
                        };
                        athletes[athleteIndex].analyses.push(analysis);
                        localStorage.setItem("athletes", JSON.stringify(athletes));
                        loadAthletes();
                        loadAthleteSelects();
                        alert("An√°lisis guardado para el deportista.");
                    }

                    // Mostrar resultado
                    document.getElementById("analysisOutput").innerHTML = `
                        <h4>An√°lisis Guardado para ${athletes[athleteIndex].nombre} ${athletes[athleteIndex].apellidos}:</h4>
                        <p><strong>Representaci√≥n/Simbolismo:</strong> ${symbolism}</p>
                        <p><strong>Significado y Trauma:</strong> ${trauma}</p>
                        <p><strong>Preguntas para Explorar:</strong> ${questions}</p>
                        <p><strong>C√≥mo Sanarlo:</strong> ${healing}</p>
                        <p><strong>Tarea Diaria (Tip):</strong> ${tip}</p>
                    `;
                });
            } else {
                console.error("Elemento analysisForm no encontrado.");
            }

            // Cargar an√°lisis por deportista
            function loadAnalyses() {
                const athleteId = document.getElementById("viewAthlete").value;
                const tableBody = document.getElementById("analysesTable").querySelector("tbody");
                const table = document.getElementById("analysesTable");
                table.classList.add("hidden");
                tableBody.innerHTML = "";
                if (athleteId) {
                    const athletes = getAthletes();
                    const athlete = athletes.find(a => a.id === athleteId);
                    if (athlete && athlete.analyses.length > 0) {
                        athlete.analyses.forEach(analysis => {
                            const row = document.createElement("tr");
                            row.innerHTML = `
                                <td>${analysis.objeto}</td>
                                <td>${analysis.estado}</td>
                                <td>${analysis.color}</td>
                                <td>${analysis.textura}</td>
                                <td>${analysis.tama√±o}</td>
                                <td>${analysis.simbolismo.substring(0, 50)}...</td>
                                <td>${analysis.trauma.substring(0, 50)}...</td>
                                <td>${new Date(analysis.fecha).toLocaleDateString()}</td>
                            `;
                            tableBody.appendChild(row);
                        });
                        table.classList.remove("hidden");
                    } else {
                        alert("No hay an√°lisis para este deportista.");
                    }
                }
            }

            // Exportar a CSV
            function exportData() {
                const athletes = getAthletes();
                let csv = "ID,Nombre,Apellidos,Telefono,Email,Deporte,Fecha Nacimiento,Hora Nacimiento,Objeto,Estado,Color,Textura,Tama√±o,Simbolismo,Trauma,Preguntas,Sanacion,Tip,Fecha An√°lisis\n";
                athletes.forEach(athlete => {
                    if (athlete.analyses && athlete.analyses.length > 0) {
                        athlete.analyses.forEach(analysis => {
                            csv += `"${athlete.id}","${athlete.nombre}","${athlete.apellidos}","${athlete.telefono}","${athlete.mail}","${athlete.deporte}","${athlete.fecha_nacimiento}","${athlete.hora_nacimiento}","${analysis.objeto}","${analysis.estado}","${analysis.color}","${analysis.textura}","${analysis.tama√±o}","${analysis.simbolismo.replace(/"/g, '""')}","${analysis.trauma.replace(/"/g, '""')}","${analysis.preguntas.replace(/"/g, '""')}","${analysis.sanacion.replace(/"/g, '""')}","${analysis.tip.replace(/"/g, '""')}","${analysis.fecha}"\n";
                        });
                    } else {
                        csv += `"${athlete.id}","${athlete.nombre}","${athlete.apellidos}","${athlete.telefono}","${athlete.mail}","${athlete.deporte}","${athlete.fecha_nacimiento}","${athlete.hora_nacimiento}","","","","","","","","","",""\n";
                    }
                });
                const blob = new Blob([csv], { type: "text/csv" });
                const url = URL.createObjectURL(blob);
                const a = document.createElement("a");
                a.href = url;
                a.download = "mindsight_datos_completos.csv";
                a.click();
                alert("Datos exportados como CSV. √Åbrelo en Excel para an√°lisis.");
            }
        });
    </script>

</body>
</html>
```